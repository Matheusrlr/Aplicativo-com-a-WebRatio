(function(GLOBAL,undefined,define){var jsDump;
(function(){function quote(str){return'"'+str.toString().replace(/"/g,'\\"')+'"'}function literal(o){return o+""}function join(pre,arr,post){var s=jsDump.separator(),base=jsDump.indent();inner=jsDump.indent(1);if(arr.join)arr=arr.join(","+s+inner);if(!arr)return pre+post;return[pre,inner+arr,base+post].join(s)}function array(arr){var i=arr.length,ret=Array(i);this.up();while(i--)ret[i]=this.parse(arr[i]);this.down();return join("[",ret,"]")}var reName=/^function (\w+)/;jsDump={parse:function(obj,type){var parser=
this.parsers[type||this.typeOf(obj)];type=typeof parser;return type=="function"?parser.call(this,obj):type=="string"?parser:this.parsers.error},typeOf:function(obj){var type=typeof obj,f="function";return type!="object"&&type!=f?type:!obj?"null":obj.exec?"regexp":obj.getHours?"date":obj.scrollBy?"window":obj.nodeName=="#document"?"document":obj.nodeName?"node":obj.item?"nodelist":obj.callee?"arguments":obj.call||obj.constructor!=Array&&(obj+"").indexOf(f)!=-1?f:"length"in obj?"array":type},separator:function(){return this.multiline?
this.HTML?"\x3cbr /\x3e":"\n":this.HTML?"\x26nbsp;":" "},indent:function(extra){if(!this.multiline)return"";var chr=this.indentChar;if(this.HTML)chr=chr.replace(/\t/g,"   ").replace(/ /g,"\x26nbsp;");return Array(this._depth_+(extra||0)).join(chr)},up:function(a){this._depth_+=a||1},down:function(a){this._depth_-=a||1},setParser:function(name,parser){this.parsers[name]=parser},quote:quote,literal:literal,join:join,_depth_:1,parsers:{window:"[Window]",document:"[Document]",error:"[ERROR]",unknown:"[Unknown]",
"null":"null",undefined:"undefined","function":function(fn){var ret="function",name="name"in fn?fn.name:(reName.exec(fn)||[])[1];if(name)ret+=" "+name;ret+="(";ret=[ret,this.parse(fn,"functionArgs"),"){"].join("");return join(ret,this.parse(fn,"functionCode"),"}")},array:array,nodelist:array,arguments:array,object:function(map){var ret=[];this.up();for(var key in map)ret.push(this.parse(key,"key")+": "+this.parse(map[key]));this.down();return join("{",ret,"}")},node:function(node){var open=this.HTML?
"\x26lt;":"\x3c",close=this.HTML?"\x26gt;":"\x3e";var tag=node.nodeName.toLowerCase(),ret=open+tag;for(var a in this.DOMAttrs){var val=node[this.DOMAttrs[a]];if(val)ret+=" "+a+"\x3d"+this.parse(val,"attribute")}return ret+close+open+"/"+tag+close},functionArgs:function(fn){var l=fn.length;if(!l)return"";var args=Array(l);while(l--)args[l]=String.fromCharCode(97+l);return" "+args.join(", ")+" "},key:quote,functionCode:"[code]",attribute:quote,string:quote,date:quote,regexp:literal,number:literal,"boolean":literal},
DOMAttrs:{id:"id",name:"name","class":"className"},HTML:false,indentChar:"   ",multiline:true}})();;(function(){"use strict";'use strict';var l;function m(a,b){a=a.split(".");for(var c=GLOBAL,d;a.length&&(d=a.shift());)a.length||void 0===b?c=c[d]?c[d]:c[d]={}:c[d]=b};function aa(){throw Error("Unimplemented abstract method");}function ba(a){if(a){var b=function(){};b.prototype=a;a=new b}else a={};return a}function ca(a){var b=fa;a._super=b.prototype;a.prototype=ba(b.prototype);a.prototype.constructor=a};m("wr.mvc.VALIDATION_VALIDATOR_KEY","wrValidation");var ga={integer:"typeValidation.integer",float:"typeValidation.float",decimal:"typeValidation.decimal",date:"typeValidation.date",time:"typeValidation.time",timestamp:"typeValidation.timestamp"};function n(a,b){a.$$phase?b&&b(a):a.$apply(b)}function ha(a){return function(){this.$parent=this.$$wrDisconnectedParent;return a.apply(this,arguments)}}
function ia(a){function b(a){return a.replace(k,function(a,b,c,d){return d?c.toUpperCase():c})}function c(a,c){return(a=a.exec(c.nodeValue))?b(a[1]):null}if(a.restrict)throw Error("Cannot specify 'restrict' for a comment-wrapped directive");var d=a.link,e=a.compile||function(){return d},f=/^\s*directive:\s*(\S+)(\s+?.+)?\s*$/i,g=/^\s*end_directive:\s*(\S+)\s*$/i,k=/([\:\-\_]+(.))/g;return angular.extend({},a,{restrict:"AM",compile:function(a,d,k){var u=a[0];if(8!==u.nodeType)return e.call(this,a,
d,k);k=f.exec(u.nodeValue);a=b(k[1]);k=k[1];d=d[a]||"";var w=0;do{if(!u)throw Error("Unterminated comment-wrapped directive: "+k+(d?" "+d:""));8===u.nodeType?c(f,u)===a?w++:c(g,u)===a&&w--:1===w&&1===u.nodeType&&u.setAttribute(k,d||"");u=u.nextSibling}while(0<w)}})}function ja(){return"Android"===device.platform||"android"===device.platform||"amazon-fireos"===device.platform||"Amazon"===device.platform?"android":"iOS"===device.platform?"ios":"windows"===device.platform?"windows":"other"};function ka(){this._rules=this._tokenExpr=null;var a={},b="adEGHhMmsywZ";la({y:{"%":"y"},M:{"%":"M"},d:{"%":"d"},E:{"%":"E"},H:{"%":"H"},h:{"%":"h"},m:{"%":"m"},s:{1:"s",2:"ss",3:"SSS","":"SSS"},a:{"%":"a"},Z:{"%":"Z"},w:{"%":"W"},G:{"%":"G"}},function(c,d){if(1!=c.length)throw Error("Symbols must be single characters");0>b.indexOf(c)&&(b+=c);a[c]=ma(d)});this._tokenExpr=function(a,b){var e=b.replace(/([\]\^])/g,"\\$1");b=[];b.push("(");b.push(e);b.push("[^");b.push(e);b.push("]+");b.push(e);b.push(")|(");
for(e=0;e<a.length;e++)b.push("["+a[e].replace(/([\]\^])/g,"\\$1")+"]+"),e<a.length-1&&b.push("|");b.push(")|(.)");return new RegExp(b.join(""),"g")}(b,"'");this._rules=a}
function ma(a){if("string"===typeof a)return[a];if("object"===typeof a){var b=[];la(a,function(a,d){if(!/^(?:\d+(?:,\d+)?)?|%$/.test(a))throw Error("Invalid symbol range");if("%"===a){var e="";for(a=1;6>=a;a++)e+=d,b[a]=""+e}else for(e=a?a.split(","):[0,0],e=[Number(e[0]),Number(e[1]||e[0])],a=e[0];a<=e[1];a++)b[a]=d});return b}throw Error("Invalid translation object");}function la(a,b){for(var c in a)a.hasOwnProperty(c)&&b.call(a,c,a[c])};var p={};p[wrm.l10n.NameWidth.NARROW]="narrow";p[wrm.l10n.NameWidth.ABBREVIATED]="abbreviated";p[wrm.l10n.NameWidth.SHORT]="abbreviated";p[wrm.l10n.NameWidth.WIDE]="wide";var r={};r[wrm.l10n.NameWidth.NARROW]="narrow";r[wrm.l10n.NameWidth.ABBREVIATED]="abbreviated";r[wrm.l10n.NameWidth.SHORT]="short";r[wrm.l10n.NameWidth.WIDE]="wide";var na="sun mon tue wed thu fri sat".split(" ");
function oa(a,b){function c(a,b){return new Promise(function(c,d){navigator.globalization.getDateNames(function(a){c(a.value)},function(a){d(wrm.util.toError(a))},{type:b,item:a})})}var d=wrm.l10n.NameWidth,e=null,f={},g={},k=null,q=null,h=[];h.push(function(){return new Promise(function(a,b){navigator.globalization.getLocaleName(function(b){a(b.value)},function(a){b(wrm.util.toError(a))})})}().then(function(a){e=a}));h.push(c("months","narrow").then(function(a){f[d.NARROW]=a;f[d.ABBREVIATED]=a;f[d.SHORT]=
a}));h.push(c("months","wide").then(function(a){f[d.WIDE]=a}));h.push(c("days","narrow").then(function(a){g[d.NARROW]=a;g[d.ABBREVIATED]=a;g[d.SHORT]=a}));h.push(c("days","wide").then(function(a){g[d.WIDE]=a}));h.push(function(){return new Promise(function(a,b){navigator.globalization.getNumberPattern(a,function(a){b(wrm.util.toError(a))},{type:"decimal"})})}().then(function(a){k=a.decimal;q=a.grouping}));return Promise.all(h).then(function(){if(b!==e)return null;var c=new pa(a,e);wrm.util.obj.getEnumValues(d).forEach(function(a){qa(c,
a,f[a]);ra(c,a,g[a])});t(c,["numbers","symbols-numberSystem-latn","decimal"],k);t(c,["numbers","symbols-numberSystem-latn","group"],q);return c.getData()})};function sa(a){this._cldr=a}sa.prototype.getMonthNames=function(a){var b=this._cldr.main(["dates/calendars/gregorian/months/format",p[a]]);return Object.keys(b).map(function(a){return b[a]})};sa.prototype.getDayNames=function(a){var b=this._cldr.main(["dates/calendars/gregorian/days/format",r[a]]);return Object.keys(b).map(function(a){return b[a]})};
sa.prototype.getFirstDayOfWeek=function(){var a=this._cldr.get(["supplemental/weekData/firstDay",this._cldr.attributes.region]);if("string"!==typeof a)throw Error("No first-day-of-week information in locale data");return na.indexOf(a)};function v(a,b,c){this._defaultLocale=a;this._$http=b;this._globalizeDataPromises={};this._initializePromise=this._forcedLocale=null;this._log=c.createLog("wr.mvc.l10n.LocalizationManager");this._customFormatters={}}m("wr.mvc.l10n.LocalizationManager",v);v.$inject=["WRAPP_DEFAULT_LOCALE","$http","wrLogger"];
v.prototype.initialize=function(a){var b=this;if(!this._initializePromise)this._l10nService=a,this._initializePromise=Promise.resolve().then(function(){return ta(b)}).then(function(){return ua(b)});else if(this._l10nService!==a)throw Error("Already initialized with a different localization service");return this._initializePromise};
function ta(a){var b=a._defaultLocale;a=[va(a,"supplemental"),va(a,"main-"+b)];return Promise.all(a).then(function(a){if(!a[0])throw Error("Supplemental CLDR data not found");if(!a[1])throw Error("Default locale CLDR data not found");}).then(function(){Globalize.locale(b)})}v.prototype.refreshLocale=function(){return ua(this)};v.prototype.refreshLocale=v.prototype.refreshLocale;v.prototype.overrideLocale=function(a){this._forcedLocale=a;return ua(this)};v.prototype.overrideLocale=v.prototype.overrideLocale;
function ua(a){var b=a._log;return Promise.resolve().then(function(){return a._forcedLocale?a._forcedLocale:wa()}).then(function(b){var d=b!==a._currentLocale;a._currentLocale=b;return d}).then(function(c){if(!c)return!1;b.debug("Current locale is",a._currentLocale);return xa(a).then(function(){return!0})})}function wa(){return new Promise(function(a,b){GLOBAL.navigator.globalization.getLocaleName(function(b){a(b.value)},function(a){b(wrm.util.toError(a))})})}
function xa(a){var b=wrm.data.Type,c=ya,d=a._l10nService,e=Promise.resolve().then(function(){return za(a)}).then(function(){return Aa(a)}),e=e.then(function(){return Ba(a)}),e=e.then(function(){return d.refreshLocale()});return e.then(function(){var f={};[b.DATE,b.TIME,b.TIMESTAMP].forEach(function(b){var e=d.getPreferredTypePattern(b)||a._deviceDateTimePatterns[b][c.SHORT];f[b]=a._createDateTimeFormatter(b,{pattern:e})});[b.INTEGER,b.FLOAT,b.DECIMAL].forEach(function(c){var e=d.getPreferredTypePattern(c)||
a._deviceNumberPatterns[c];f[c]=a._createNumberFormatter(c,{pattern:e,maxFractionDigits:c===b.INTEGER?0:void 0})});a._defaultFormatters=f;a._customFormatters={}})}function za(a){var b=wrm.data.Type,c={},b=[["date",b.DATE],["time",b.TIME],["date and time",b.TIMESTAMP]].map(function(a){return Ca(a[0]).then(function(b){c[a[1]]=b})});return Promise.all(b).then(function(){a._deviceDateTimePatterns=c})}
function Ca(a){function b(b){return new Promise(function(c,d){GLOBAL.navigator.globalization.getDatePattern(function(a){c(a.pattern)},function(a){d(wrm.util.toError(a))},{formatLength:b,selector:a})})}var c=ya,d={},e=[["short",c.SHORT],["medium",c.MEDIUM],["long",c.LONG],["full",c.FULL]].map(function(a){return b(a[0]).then(function(b){d[a[1]]=b})});return Promise.all(e).then(function(){var a=[c.SHORT,c.MEDIUM,c.LONG,c.FULL],b=null;a.forEach(function(a){b||(b=d[a])});a.forEach(function(a){d[a]?b=d[a]:
d[a]=b});return d})}function Aa(a){function b(){return new Promise(function(a,b){GLOBAL.navigator.globalization.getNumberPattern(function(b){a(b.pattern)},function(a){b(wrm.util.toError(a))},{type:"decimal"})})}var c=wrm.data.Type;return Promise.resolve().then(function(){return b()}).then(function(b){var e={};e[c.INTEGER]=b;e[c.FLOAT]=b;e[c.DECIMAL]=b;a._deviceNumberPatterns=e})}
function Ba(a){var b=a._log,c=a._defaultLocale,d=a._currentLocale;return Promise.resolve().then(function(){return va(a,"main-"+d.replace(/-/g,"_"))}).then(function(a){return a?!0:oa(Globalize.locale(c),d).then(function(a){return a?(b.warn("Locale information for",d,"inferred from device data"),Globalize.load(a),!0):!1})}).then(function(b){b=new Globalize(b?d:c);a._globalize=b})}
function va(a,b){var c=a._globalizeDataPromises[b];c||(c=a._$http,c=c({method:"GET",url:"app/lib/cldr/"+b+".json",responseType:"json"}).then(function(a){return(a=a.data)&&"object"===typeof a?(Globalize.load(a),!0):!1},function(a){switch(a.status){case 404:case 500:case 0:case -1:return!1}throw Error("Error loading CLDR bundle '"+b+"' - "+a.status+" ("+a.statusText+")");}),a._globalizeDataPromises[b]=c);return c}
function x(a,b,c,d,e){var f;if(e){var g;f="";for(g=0;g<Da.length;g++)f+=","+String(e[Da[g]]);g=f;(f=a._customFormatters[g])||(a._customFormatters[g]=f=d.call(a,c,e))}else f=a._defaultFormatters[c];return f(b)}function Ea(a,b,c){var d=a._log;return function(a){if(null===a||void 0===a)return"";var f;try{f=wrm.data.toSingle(b,a)}catch(g){return d.warn("Value not convertible to "+b,g),String(a)}return null===f||void 0===f?"":c(f)}}v.prototype.getCurrentLocale=function(){return this._currentLocale};
v.prototype.getCurrentLocale=v.prototype.getCurrentLocale;v.prototype.getLocaleInfo=function(){return new sa(this._globalize.cldr)};v.prototype.getLocaleInfo=v.prototype.getLocaleInfo;var ya={SHORT:"short",MEDIUM:"medium",LONG:"long",FULL:"full"};v.Style=ya;v.DateTimeFormatOptions=v.DateTimeFormatOptions;v.prototype.formatDate=function(a,b){return x(this,a,wrm.data.Type.DATE,this._createDateTimeFormatter,b)};v.prototype.formatDate=v.prototype.formatDate;
v.prototype.formatTime=function(a,b){return x(this,a,wrm.data.Type.TIME,this._createDateTimeFormatter,b)};v.prototype.formatTime=v.prototype.formatTime;v.prototype.formatTimestamp=function(a,b){return x(this,a,wrm.data.Type.TIMESTAMP,this._createDateTimeFormatter,b)};v.prototype.formatTimestamp=v.prototype.formatTimestamp;
v.prototype._createDateTimeFormatter=function(a,b){var c=wrm.data.Type,d={};if(b.pattern)d.raw=b.pattern;else if(b.style)switch(a){case c.DATE:d.date=b.style;break;case c.TIME:d.time=b.style;break;case c.TIMESTAMP:d.datetime=b.style}var e=this._globalize.dateFormatter(d);return Ea(this,a,function(a){return e(a.asDate())})};v.NumberFormatOptions=v.NumberFormatOptions;v.prototype.formatInteger=function(a,b){return x(this,a,wrm.data.Type.INTEGER,this._createNumberFormatter,b)};
v.prototype.formatInteger=v.prototype.formatInteger;v.prototype.formatFloat=function(a,b){return x(this,a,wrm.data.Type.FLOAT,this._createNumberFormatter,b)};v.prototype.formatFloat=v.prototype.formatFloat;v.prototype.formatDecimal=function(a,b){return x(this,a,wrm.data.Type.DECIMAL,this._createNumberFormatter,b)};v.prototype.formatDecimal=v.prototype.formatDecimal;
v.prototype._createNumberFormatter=function(a,b){var c=wrm.data.Type,d={};b.pattern&&(d.raw=b.pattern);if("number"===typeof b.minFractionDigits||"number"===typeof b.maxFractionDigits)d.minimumFractionDigits="number"===typeof b.minFractionDigits?b.minFractionDigits:0,d.maximumFractionDigits="number"===typeof b.maxFractionDigits?b.maxFractionDigits:20;var e=this._globalize.numberFormatter(d);return a===c.DECIMAL?Ea(this,a,function(a){try{return e(a.toNumber())}catch(b){var c=this._globalize.cldr.main("numbers/symbols-numberSystem-latn");
return a.toLocaleString({groupSeparator:c.group,decimalSeparator:c.decimal})}}):Ea(this,a,e)};v.prototype.formatMessage=function(a,b){return this._l10nService.formatMessage(a,b)};v.prototype.formatMessage=v.prototype.formatMessage;var Da=["style","minFractionDigits","maxFractionDigits","pattern"];function Fa(a,b,c){function d(a,c,d){c=c||"mediumDate";switch(c){case "wr-date":return b.formatDate(a);case "wr-time":return b.formatTime(a);case "wr-timestamp":return b.formatTimestamp(e(a,d));case "medium":return b.formatTimestamp(e(a,d),{style:f.MEDIUM});case "short":return b.formatTimestamp(e(a,d),{style:f.SHORT});case "fullDate":return b.formatDate(a,{style:f.FULL});case "longDate":return b.formatDate(a,{style:f.LONG});case "mediumDate":return b.formatDate(a,{style:f.MEDIUM});case "shortDate":return b.formatDate(a,
{style:f.SHORT});case "mediumTime":return b.formatTime(a,{style:f.MEDIUM});case "shortTime":return b.formatTime(a,{style:f.SHORT});default:k||(k=new ka);var g=k,w=[],D;for(g._tokenExpr.lastIndex=0;D=g._tokenExpr.exec(c);){var M=D[2],R=M&&M.charAt(0),M=M&&M.length;D=D[1]||D[3];R&&(D=(R=g._rules[R])?R[M]||R[0]:D);D&&w.push(D)}c=w.join("");return b.formatTimestamp(e(a,d),{pattern:c})}}function e(a,b){if(void 0===b)return a;var c=wrm.data.toTimestamp(a);if(!c)return a;var d;if("UTC"===b)d=0;else if(d=
Date.parse("Jan 01, 1970 00:00:00 "+b)/6E4,isNaN(d))return g.warn("Unrecognized timezone",b),a;a=c.asDate();d=a.getTimezoneOffset()-d;return new Date(a.valueOf()+6E4*d)}var f=ya,g=c.createLog("wr.mvc.l10n.dateDecorator"),k=null;d.$stateful=!0;return d}m("wr.mvc.l10n.dateDecorator",Fa);Fa.$inject=["$delegate","wrLocalizationManager","wrLogger"];function Ga(a,b){function c(){var a=arguments[0],c=void 0,f="wr-decimal",g=void 0;2==arguments.length?"wr-integer"===arguments[1]||"wr-float"===arguments[1]||"wr-decimal"===arguments[1]?f=arguments[1]:c=arguments[1]:2<arguments.length&&(c=arguments[1],f=arguments[2]);c&&(g={maxFractionDigits:c});return"wr-integer"===f?b.formatInteger(a,g):"wr-float"===f?b.formatFloat(a,g):b.formatDecimal(a,g)}c.$stateful=!0;return c}m("wr.mvc.l10n.numberDecorator",Ga);Ga.$inject=["$delegate","wrLocalizationManager"];function Ha(){this._ctrl=null;this._open=!1;this._closing=this._closeTimeout=this._eventHandlers=null}function Ia(a){var b=Ja;if(b._ctrl)throw Error("A feedback controller is already attached");b._ctrl=a;return{detachController:b._detachController.bind(b),throwEvent:b._throwEvent.bind(b)}}Ha.prototype._detachController=function(){Ka(this);this._ctrl=null};Ha.prototype.show=function(a,b,c){var d=this;return Ka(this).then(function(){La(d,a,b,c)})};Ha.prototype.close=function(){return Ka(this)};
function La(a,b,c,d){Ma(Na(a),b);a._open=!0;a._eventHandlers=angular.extend({},d);c&&0<c&&(a._closeTimeout=GLOBAL.setTimeout(function(){a._throwEvent("Close")},c))}function Ka(a){if(!a._open)return Promise.resolve();if(a._closing)return a._closing;var b=Na(a);a._closeTimeout&&(GLOBAL.clearTimeout(a._closeTimeout),a._closeTimeout=null);a._closing=Oa(b).then(function(){a._open=!1;a._eventHandlers=null;a._closing=null});return a._closing}
Ha.prototype._throwEvent=function(a,b){var c=Promise.resolve(),d=this._eventHandlers[a];d&&(c=c.then(function(){d(b||{})}));Ka(this);return c};function Na(a){if(!a._ctrl)throw Error("Feeback controller is not available");return a._ctrl};function y(){}m("wr.mvc.ui.BlobProvider",y);y.Attributes=y.Attributes;var Pa={height:void 0,quality:void 0,width:void 0};y.prototype.capture=aa;y.prototype.capture=y.prototype.capture;y.prototype.select=aa;y.prototype.select=y.prototype.select;function Qa(){this._options={quality:50,destinationType:Camera.DestinationType.FILE_URI,allowEdit:!1,mediaType:Camera.MediaType.PICTURE,correctOrientation:"android"===ja()?!0:!1};this._contentMap={image:Camera.EncodingType.JPEG,"image/jpeg":Camera.EncodingType.JPEG,"image/png":Camera.EncodingType.PNG}}Qa.prototype.capture=function(a,b){return Ra(this,Camera.PictureSourceType.CAMERA,a,b)};Qa.prototype.select=function(a,b){return Ra(this,Camera.PictureSourceType.PHOTOLIBRARY,a,b)};
function Ra(a,b,c,d){d=d||Pa;var e=angular.extend({},a._options);e.sourceType=b;e.encodingType=Sa(a,c);void 0!==d.width&&(e.targetWidth=d.width);void 0!==d.height&&(e.targetHeight=d.height);void 0!==d.quality&&(e.quality=Math.ceil(Math.max(0,Math.min(100,d.quality))/100*100));return Ta(e).then(function(a){return a})}function Ta(a){return new Promise(function(b,c){return navigator.camera.getPicture(function(a){b(Ua(a))},function(a){c(a)},a)})}
function Ua(a){return wrm.util.fs.lookupFile(a).then(function(a){return wrm.data.Blob.fromFile(a,a.type||void 0,{fileName:a.name})})}function Sa(a,b){b=b||"image/jpeg";a=a._contentMap[b];if(void 0===a)throw Error("Content type "+b+" is not supported");return a};function Va(a,b,c){return new Promise(function(d){navigator.notification.alert(a,d,b,c)})}m("wr.mvc.ui.showAlert",Va);function Wa(a,b,c,d){d=d||0;return new Promise(function(e){navigator.notification.confirm(a,function(a){e(0<a?a-1:d)},b,c)})}m("wr.mvc.ui.showConfirm",Wa);
function Ya(a,b,c,d,e,f){f=f||0;return new Promise(function(g){accountmanager.loginPrompt(a,function(a){g({buttonIndex:0<a.buttonIndex?a.buttonIndex-1:f,username:a.username,password:a.password})},{title:b,usernameDefault:c||"",usernameReadOnly:d,buttonLabels:e})})}m("wr.mvc.ui.showCredentialsPrompt",Ya);var Ja=new Ha;m("wr.mvc.ui.FEEDBACK_CLOSE_EVENT_TYPE","Close");function Za(a,b,c){return Ja.show(a,b,c)}m("wr.mvc.ui.showFeedback",Za);
function $a(a){if(a!==wrm.data.Type.BLOB)throw Error("Not a binary object type");return new Qa}m("wr.mvc.ui.createBlobProvider",$a);function ab(a,b){return new Promise(function(c,d){cordova.plugins.fileOpener2.open(decodeURI(a),b,{success:function(){c(void 0)},error:function(a){d(Error("Unable to open the file: "+a.message))}})})}m("wr.mvc.ui.openFileViewer",ab);function bb(a,b,c,d){this._$rootScope=a;this._manager=b;this._l10nManager=c;this._l10nReady=!1;this._log=d.createLog("wr.mvc.route.Interactor");this._activity={started:!1,paused:!1,startTimeout:null,lastProgress:null};a.$on("wrActivityStart",this._handleActivityEvent.bind(this));a.$on("wrActivityProgress",this._handleActivityEvent.bind(this));a.$on("wrActivityStop",this._handleActivityEvent.bind(this))}
bb.prototype.init=function(){var a=this;return this._l10nReady?Promise.resolve():(this._l10nReady=!0,this._manager.getLocalizationService().then(function(b){return a._l10nManager.initialize(b)}))};bb.prototype.presentDialog=function(a){var b=this;cb(this,!0);return(a instanceof wrm.nav.LoginDialog?db(this,a):eb(this,a)).then(function(a){cb(b,!0);fb(b,!0);return a},function(a){cb(b,!0);fb(b,!0);throw a;})};
function db(a,b){var c=a._log,d=b.getMessage(),e=a._l10nManager.formatMessage("loginDialog.title"),f=b.getChoiceLabels(),g=0===f.length;0===f.length&&f.push(a._l10nManager.formatMessage("dialog.button.OK"));return Ya(d,e,b.getDefualtUsername(),b.isUsernameChangeForbidden(),f,b.getDefaultChoiceIndex()).then(function(a){return{value:g?void 0:b.getChoiceValue(a.buttonIndex),data:{username:a.username,password:a.password}}})["catch"](function(a){c.error("Error displaying login prompt",a)})}
function eb(a,b){var c=wrm.nav.Dialog.Flavor,d=a._log,e;switch(b.getFlavor()){case c.POSITIVE:return Promise.reject(Error("Positive dialogs are not supported"));case c.CAUTIONAL:c=b.getMessage();e=a._l10nManager.formatMessage("dialog.title.warning");break;default:c=b.getMessage(),e=a._l10nManager.formatMessage("dialog.title.error")}var f=b.getChoiceLabels(),g=0===f.length;0===f.length&&f.push(a._l10nManager.formatMessage("dialog.button.OK"));return Wa(c,e,f,b.getDefaultChoiceIndex()).then(function(a){return{value:g?
void 0:b.getChoiceValue(a),data:{}}})["catch"](function(a){d.error("Error displaying confirmation",a)})}bb.prototype.progressActivity=function(a){var b=this._activity;b.started&&!b.paused&&(b.lastProgress=a,b.startTimeout||gb(this,a))};
function fb(a,b,c){function d(){e._$rootScope.$broadcast("wrActivityStart");f.lastProgress&&gb(e,f.lastProgress);f.startTimeout=null}var e=a,f=a._activity;if(!b||f.started)f.started=!0,f.paused=!1,b||(f.lastProgress=null),c?d():f.startTimeout=GLOBAL.setTimeout(d,700)}function cb(a,b){var c=a._activity;c.started&&(b?c.paused=!0:(c.started=!1,c.paused=!1,c.lastProgress=null),c.startTimeout?(GLOBAL.clearTimeout(c.startTimeout),c.startTimeout=null):a._$rootScope.$broadcast("wrActivityStop"))}
function gb(a,b){a._$rootScope.$broadcast("wrActivityProgress",{message:b.getMessage()})}bb.prototype._handleActivityEvent=function(a,b){var c=this._$rootScope;switch(a.name){case "wrActivityStart":c.activity={message:null};break;case "wrActivityProgress":c.activity&&(c.activity.message=b.message);break;case "wrActivityStop":c.activity=null}};function z(a){this._direction=a}m("wr.mvc.route.ScreenSwitchInfo",z);z.prototype.getDirection=function(){return this._direction};z.prototype.getDirection=z.prototype.getDirection;function hb(a,b,c,d){ib.push(this);this._$rootScope=a;this._$routeParams=b;this._$location=c;this._lastSwitch=this._pendingSwitch=null;a.$on("$routeChangeSuccess",this._handleRouteChangeSuccess.bind(this));a.$on("$routeChangeError",this._handleRouteChangeError.bind(this));a.$on("$viewContentLoaded",this._handleViewContentLoaded.bind(this));this._renderingProviderFactory=this._directSwitchHandler=null;this._log=d.createLog("wr.mvc.route.ScreenSwitcher")}var ib=[];
hb.prototype._handleRouteChangeSuccess=function(){var a=this._$routeParams.screenId||null;this._log.debug("Route change succeeded for location",this._$location.url(),"reaching screen",a);var b=this._pendingSwitch;b&&(this._lastSwitch=b,this._pendingSwitch=null,a===b.requestedScreenId?(this._log.debug("Completed switch to screen",b.requestedScreenId),b.resolve(void 0)):(this._log.error("Failed switch to screen",b.requestedScreenId,": instead reached",a),A(this,"wrScreenSwitchFailure",b),b.reject(Error("Switched to unexpected screen '"+
a+"'"))))};hb.prototype._handleRouteChangeError=function(){this._log.error("Route change failed for location",this._$location.url());var a=this._pendingSwitch;a&&(this._pendingSwitch=null,this._log.error("Failed switch to screen",a.requestedScreenId),A(this,"wrScreenSwitchFailure",a),a.reject(Error("Switch failed")))};hb.prototype._handleViewContentLoaded=function(){var a=this._lastSwitch;a&&A(this,"wrScreenSwitchSuccess",a)};
hb.prototype.switchTo=function(a,b){var c=this._pendingSwitch;c&&(this._pendingSwitch=null,this._log.debug("Canceled switch to screen",c.requestedScreenId),A(this,"wrScreenSwitchFailure",c),c.reject(Error("Switch failed")));var d,c=new Promise(function(c,f){d={requestedScreenId:a,direction:b,resolve:c,reject:f}});this._pendingSwitch=d;this._log.debug("Initiating switch to screen",a);A(this,"wrScreenSwitchStart",d);this._$location.path("/screens/"+a).search("direction",b);n(this._$rootScope);return c};
function A(a,b,c){a._$rootScope.$broadcast(b,{screenId:c.requestedScreenId,backward:"backward"===c.direction})}
function jb(a,b,c){function d(a,c){var d=a.current.params.screenId;return Promise.all(ib.map(function(a){a:{if(!a._pendingSwitch){var b={requestedScreenId:d,direction:"none",resolve:angular.noop,reject:angular.noop};a._pendingSwitch=b;A(a,"wrScreenSwitchStart",b);if(a._directSwitchHandler){a=a._directSwitchHandler(d);break a}}a=void 0}return a})).then(function(){if(b){var a=b(d);if(a)return c.invoke(a)}}).then(function(){for(var a=null,b=0;b<ib.length;b++){a=ib[b];if(!a._renderingProviderFactory)throw Error("Missing rendering provider factory");
if(a=a._renderingProviderFactory(d))break}return a})}function e(a){return new z(a.current.params.direction||"none")}d.$inject=["$route","$injector"];e.$inject=["$route"];a.when("/screens/:screenId",{resolve:{wrRenderingProvider:d,wrSwitchInfo:e},templateUrl:function(a){return c(a.screenId)}})};function kb(){this._scopes=[];var a=!1,b=!1,c=this._scopes;this._view=Object.create(Object.prototype,{updating:{get:function(){return a},set:function(b){a=b;this.applyChanges()}},_updatingBG:{get:function(){return b},set:function(a){b=a;this.applyChanges()}},applyChanges:{value:function(){for(var a=0;a<c.length;a++){var b=c[a];b.$$phase||b.$applyAsync(void 0)}}}})}kb.prototype.getView=function(){return this._view};
kb.prototype.attachScope=function(a){var b=this._scopes;b.push(a);var c=a.$on("$destroy",function(){c();for(var d=0;d<b.length;d++)b[d]===a&&b.splice(d--,1)})};function lb(a,b){Object.defineProperty(a,"$$hashKey",{writable:!0,value:b})};function mb(a){this._uniqueId=nb++;this._formCtrls=[];this._modelCtrls={};this._propertyStates={};this._formState=ob(this._formCtrls,this._modelCtrls,this._propertyStates,a)}var nb=0;
function ob(a,b,c,d){function e(a,c){var d=b[a];if(!d&&!c)throw Error("No input control found for property '"+a+"'");return d}return{setValidity:function(b){a.forEach(function(a){a.$setValidity("wrValidation",b,a)})},publishValidViewValues:function(){Object.keys(c).forEach(function(a){var d=b[a];c[a].valid&&void 0===d.$modelValue&&null!==d.$$rawModelValue&&d.$modelValue!==d.$$rawModelValue&&(d.$modelValue=d.$$rawModelValue,d.$$writeModelToScope())})},getProperty:function(a){return c[a]||null},setPropertyValidity:function(a,
b){e(a,!1).$setValidity("wrValidation",b)},getPropertyPlatformValidity:function(a){return(a=e(a,!0))?!pb(a):!0},getPlatformValidity:function(){var b=!0;a.forEach(function(a){b&&pb(a)&&(b=!1)});return b},getPropertyPlatformErrors:function(a){var b=e(a,!0),c=[];b&&Object.keys(ga).forEach(function(a){b.$error&&b.$error[ga[a]]&&c.push(d._l10nManager.formatMessage(ga[a]))});return c},clearPropertyDirtiness:function(a){if(a=e(a,!0))a.$setPristine(),a.$setUntouched()}}}
function qb(a,b,c,d){var e=a._modelCtrls[b];if(e){if(e!==c)throw Error("Already added another model controller for property '"+b+"'");}else d&&1===rb(a,d,1)&&a._formCtrls.push(d),a._modelCtrls[b]=c,a._propertyStates[b]=sb(c)}function rb(a,b,c){a="_wr_holdCount_"+a._uniqueId;var d=b[a];void 0===d&&(Object.defineProperty(b,a,{writable:!0,value:0}),d=0);c=d+c;return b[a]=c}
function sb(a){function b(a){return{configurable:!0,enumerable:!0,get:a}}return Object.create(null,{value:b(function(){return a.$$rawModelValue}),dirty:b(function(){return a.$dirty}),valid:b(function(){return a.$valid}),invalid:b(function(){return a.$invalid})})}function pb(a){a=Object.keys(a.$error);switch(a.length){case 0:return!1;case 1:return"wrValidation"!==a[0];default:return!0}};function tb(a,b,c){this._id=ub++;this._scope=a;this._element=new vb(b);this._connected=!0;this._destroyScheduled=this._destroyAfterRelease=!1;this._log=c}var ub=0;function wb(a){xb(a);return a._scope}l=tb.prototype;l.getElement=function(){xb(this);return this._element};
l.release=function(a){this.disconnect();a&&a(this);a=this._destroyAfterRelease;!a&&this._element[0].querySelector(".wr-noViewCache")&&(this._log.debug(this,"cannot be cached"),a=!0);a&&(GLOBAL.setTimeout(this.destroy.bind(this),2E3),this._destroyScheduled=!0)};
l.disconnect=function(){xb(this);if(!this._connected)throw Error("Rendering already disconnected");this._connected=!1;var a=this._scope;if(a.$root===a)throw Error("Cannot disconnect the root scope");if(a.$$wrDisconnectedParent)throw Error("Scope already disconnected");var b=a.$parent;a.$$wrDisconnectedParent=b;b.$$childHead===a&&(b.$$childHead=a.$$nextSibling);b.$$childTail===a&&(b.$$childTail=a.$$prevSibling);a.$$prevSibling&&(a.$$prevSibling.$$nextSibling=a.$$nextSibling);a.$$nextSibling&&(a.$$nextSibling.$$prevSibling=
a.$$prevSibling);a.$$nextSibling=a.$$prevSibling=null;a.$parent=null;a.$destroy=ha(a.$destroy);this._log.debug(this,"disconnected")};function xb(a){if(!a._scope||!a._element||a._destroyScheduled)throw Error("Rendering destroyed");}l.destroy=function(){if(this._connected)throw Error("Rendering still connected");if(this._scope){var a=this._scope,b=this._performDestroy.bind(this,this._scope,this._element);a.$$phase?b&&b(a):a.$applyAsync(b);this._element=this._scope=null}};
l._performDestroy=function(a,b){a.$destroy();b&&b.wrRemove();this._log.debug(this,"destroyed")};l.toString=function(){return"Rendering "+this._id};function vb(a){var b=a.detach,c=a.remove;a.detach=function(){return b.call(this)};a.remove=function(){return b.call(this)};a.wrRemove=function(){c.call(this)};return a};function fa(a){this.log=a}fa.prototype.retrieve=function(){};function yb(a,b){if(!b)throw Error("No available rendering to retrieve");var c=null;b(function(b){if(c)throw Error("Rendering already created");c=a.createRendering(b.scope,b.element)});if(!c)throw Error("Factory function failed to synchronously create a rendering");return c}fa.prototype.createRendering=function(a,b){return new tb(a,b,this.log)};function zb(a,b){this.log=b;this._screenId=a;this._cachedRendering=null}ca(zb);
zb.prototype.retrieve=function(a,b){var c=this._cachedRendering;if(c&&c._scope&&c._element&&!c._destroyScheduled){b=c;xb(b);if(b._connected)throw Error("Rendering already connected");b._connected=!0;var d=b._scope;if(!d.$$wrDisconnectedParent)throw Error("Scope not disconnected");var e=d.$$wrDisconnectedParent;d.$$wrDisconnectedParent=null;d.$$prevSibling=e.$$childTail;e.$$childHead?(e.$$childTail.$$nextSibling=d,e.$$childTail=d):e.$$childHead=e.$$childTail=d;d.$parent=e;e.$$destroyed&&d.$destroy();
delete d.$destroy;b._log.debug(b,"connected")}else this._cachedRendering=c=yb(this,b||null);a&&a(c);return c};zb.prototype.createRendering=function(a,b){a=zb._super.createRendering.call(this,a,b);this.log.debug("Created",a,"for screen",this._screenId);return a};function Ab(a,b,c,d,e){this._id=a;this._records={};this._interactor=d;this._log=e;this.switchTo(b,c)}Ab.prototype.getId=function(){return this._id};Ab.prototype.getState=function(a){return Bb(this,a).state};function Cb(a,b,c){a=Bb(a,b);(b=a.attachedViews[c])||(a.attachedViews[c]=b=new kb);return b}function Db(a,b,c){b=Bb(a,b);var d=b.modelHolders[c];d||(b.modelHolders[c]=d=new mb(a._interactor));return d}
function Eb(a){Object.keys(a._records).forEach(function(a){a=this._records[a];var c=a.renderingProvider;c._cachedRendering&&(c._cachedRendering._connected?c._cachedRendering._destroyAfterRelease=!0:c._cachedRendering.destroy(),c._cachedRendering=null);a.attachedViews={};a.modelHolders={}},a)}function Bb(a,b){a=a._records[b];if(!a)throw Error("Site does not host screen "+b);return a}
Ab.prototype.switchTo=function(a,b){var c=this._records[a];c?c.state=b:this._records[a]=c=new Fb(a,b,this._log);a=!this._currentRecord||this._currentRecord.screenId!==a;this._currentRecord=c;return a};function Gb(a){Object.keys(a._records).forEach(function(a){a!==this._currentRecord.screenId&&delete this._records[a]},a)}function Fb(a,b,c){this.screenId=a;this.state=b;this.renderingProvider=new zb(a,c);this.attachedViews={};this.modelHolders={}};function Hb(a){this._sites=[];this._removalListener=this._additionListener=null;this._log=a.createLog("wr.mvc.route.SiteStack")}function Ib(a){return 0<a._sites.length?a._sites[a._sites.length-1]:null}function Jb(a,b){b=Kb(a,b);return null!==b?a._sites[b]:null}function Lb(a,b){return a._sites[a._sites.length-1-b]||null}Hb.prototype.push=function(a){this._sites.push(a);this._additionListener&&this._additionListener(a,this);this._log.debug("Pushed 1 site. New size",this._sites.length)};
Hb.prototype.pop=function(){if(0<this._sites.length){var a=this._sites.pop();this._removalListener&&this._removalListener(a,this);this._log.debug("Popped 1 site. New size",this._sites.length);return a}return null};function Mb(a,b){b=Kb(a,b);null===b&&(b=-1);b=a._sites.splice(b+1);a._removalListener&&b.forEach(function(a){this._removalListener(a,this)},a);a._log.debug("Popped",b.length,"sites. New size",a._sites.length);return b}
function Nb(a,b){if(a._removalListener){var c=a._sites;a._sites=[];c.forEach(function(a){this._removalListener(a,this)},a)}else a._sites.length=0;a._sites.push(b);a._additionListener&&a._additionListener(b,a);a._log.debug("Replaced all sites. New size",a._sites.length)}Hb.prototype.clear=function(){var a=this._sites.length;if(this._removalListener){var b=this._sites;this._sites=[];b.forEach(function(a){this._removalListener(a,this)},this)}else this._sites.length=0;this._log.debug("Cleared",a,"sites")};
function Kb(a,b){for(var c=a._sites.length-1;0<=c;c--){var d=a._sites[c];if(d&&d._records[b])return c}return null};function Ob(){this._started=!1;this._reachedFence=null;this._fenceChanged=!1}Ob.prototype.getReachedFence=function(){Pb(this);return this._reachedFence};function Pb(a){if(!a._started)throw Error("Routing not started");}function Qb(a,b){var c=a._reachedFence!==b.getFence();a._reachedFence=b.getFence();a._started&&c&&(a._fenceChanged=!0);a._started=!0};function Rb(a){this.log=a}ca(Rb);Rb.prototype.retrieve=function(a,b){b=yb(this,b||null);a&&a(b);return b};Rb.prototype.createRendering=function(a,b){a=Rb._super.createRendering.call(this,a,b);a._destroyAfterRelease=!0;this.log.debug("Created temporary",a);return a};function B(a,b,c,d,e,f,g){this._$rootScope=a;this._manager=e;this._screenSwitcher=new hb(a,c,b,f);b=this._handleDirectlyAccessedScreen.bind(this);this._screenSwitcher._directSwitchHandler=b||null;b=this._retrieveRenderingProvider.bind(this);this._screenSwitcher._renderingProviderFactory=b||null;this._startupFinished=this._pendingDirectScreenId=null;this._triggeredOnce=!1;this._sites=new Hb(f);b=this._handleAddedSite.bind(this);this._sites._additionListener=b;b=this._handleRemovedSite.bind(this);this._sites._removalListener=
b;this._viewCacheSize=g;this._timers={};this._interactor=new bb(a,e,d,f);this._environ=new Sb(this);this._pendingSynchronizationEvent=null;this._runningNotificationCount=0;this._log=f.createLog("wr.mvc.route.Router")}m("wr.mvc.route.Router",B);B.$inject="$rootScope $location $routeParams wrLocalizationManager wrManager wrLogger WRAPP_ROUTER_VIEW_CACHE_SIZE".split(" ");
function Sb(a){this.retrieveView=a._retrieveView.bind(a);this.markObjectForViewTracking=lb;this.retrieveFormState=a._retrieveFormState.bind(a);this.handleEvent=a._handleThrownEvent.bind(a);this.enterPanel=a._handleReachedScreen.bind(a);this.presentDialog=a._interactor.presentDialog.bind(a._interactor);this.reportProgress=a._interactor.progressActivity.bind(a._interactor);this.startTimerEvents=a._startTimer.bind(a);this.stopTimerEvents=a._stopTimer.bind(a);this.retrieveEventNotifier=a._retrieveEventNotifier.bind(a)}
function Tb(a,b){jb(a,function(a){return["wrManager",function(b){return Ub(a,b)}]},b)}B.configureScreenRouting=Tb;B.prototype.notifyStartup=function(){return this.notifyUserEvent("AppStartup",void 0,{warm:!1})};B.prototype.notifyStartup=B.prototype.notifyStartup;B.prototype.notifyUserEvent=function(a,b,c){a=new wrm.nav.Event(a,b,c);return Vb(this,a,!0)};B.prototype.notifyUserEvent=B.prototype.notifyUserEvent;B.prototype.notifyEvent=function(a,b,c){a=new wrm.nav.Event(a,b,c);return Vb(this,a)};
B.prototype.notifyEvent=B.prototype.notifyEvent;B.prototype._startTimer=function(a,b){if("undefined"!==typeof this._timers[a])throw Error("Timer for "+a+" already running");b=GLOBAL.setInterval(this.notifyEvent.bind(this,"Timer",a),b);this._timers[a]=b};B.prototype._stopTimer=function(a){var b=this._timers[a];b&&(delete this._timers[a],GLOBAL.clearInterval(b))};B.prototype._retrieveEventNotifier=function(a,b){var c=this;return function(d){return c.notifyEvent(a,b||null,angular.extend({},d))}};
function Vb(a,b,c){var d=a._manager,e=a._interactor,f=a._log;c=c||!1;var g="AppStartup"===b.getType(),k=Wb(a,!1),q=k._track;f.isDebugEnabled()&&"Timer"!==b.getType()&&f.debug(k,"Notifying event",b);a._runningNotificationCount++;var h=e.init(),h=h.then(function(){c&&(cb(e),fb(e,!1,g))});g||(h=h.then(function(){return a._startupFinished}));h=h.then(function(){var a=k.getContextualStartPrimaryPanelId();return a?d.getNotifiable(a):d.getAppService()});h=h.then(function(c){b.initTarget(c);Qb(q,c);c=c.notify(b,
k);g&&(a._startupFinished=c);return c})["catch"](function(a){f.error(k,"Error during event notification",a)});h=h.then(function(c){c?c=Xb(a,c,k):(a._log.warn(k,"Unhandled event",b),c=Promise.resolve());return c});return h=h.finally(function(){c&&cb(e);a._triggeredOnce||(a._triggeredOnce=!0,a._$rootScope.$broadcast("wrEntranceComplete",{}));a._runningNotificationCount--;0===a._runningNotificationCount&&a._pendingSynchronizationEvent&&(Yb(a,[a._pendingSynchronizationEvent]),a._pendingSynchronizationEvent=
null)})}B.prototype._handleDirectlyAccessedScreen=function(a){var b=this;if(a){if(this._pendingDirectScreenId)throw Error("Another direct switch is still in progress");this._pendingDirectScreenId=a;var c=wrm.nav.Route.toService(a),d=Wb(b,!0);this._sites.clear();return Promise.resolve().then(function(){return b.notifyUserEvent("AppStartup",void 0,{warm:!0})}).then(function(){return Xb(b,c,d)})}};var Zb={};
function Ub(a,b){return b.getViewService(a).then(function(a){return a.getFormInfo()}).then(function(b){Zb[a]=b})}function Xb(a,b,c){return $b(a,b,c)["catch"](function(b){a._log.error(c,"Error during navigation",b)})}
function $b(a,b,c){var d=a._log,e=c._track;b=ac(a,b);d.isDebugEnabled()&&(c.getCaughtEvent()&&"Timer"===c.getCaughtEvent().getType()&&!b.getServiceId()||d.debug(c,"Navigating route",b));var f=a._interactor.init(),f=f.then(function(){var f=b.getServiceId();return f?a._manager.getNavigable(f).then(function(a){var f;(f=c.getCaughtEvent())?(f=f.getParameters()._wrAllowNavigationToPanel,f="function"===typeof f&&a instanceof wrm.core.PanelService?f():!0):f=!0;if(f)return Qb(e,a),a.navigate(b.getGate(),
c);a=wrm.nav.Route.toNowhere();d.debug(c,"Destination forbidden by event: navigating route",a);return a}):b});return f=f.then(function(b){b.isStationary()?(b=a._log,b.isDebugEnabled()&&(c.getCaughtEvent()&&"Timer"===c.getCaughtEvent().getType()&&!c.getReachedPanelId()||b.debug(c,"Finished navigation in panel",c.getReachedPanelId())),b=void 0):b=$b(a,b,c);return b})}B.prototype.getRunningNotificationCount=function(){return this._runningNotificationCount};B.prototype.getRunningNotificationCount=B.prototype.getRunningNotificationCount;
B.prototype.getFormInfo=function(a){var b=Zb[a];if(!b)throw Error("No form information available screen "+a);return b};B.prototype.getFormInfo=B.prototype.getFormInfo;B.prototype.validate=function(a,b,c){var d=this._manager,e=this._log,f=Wb(this,!1),g=f.getContextualStartPrimaryPanelId();return g!==a?null:Promise.resolve().then(function(){return d.getViewService(g)}).then(function(a){return a.validate(b,c||null,f)})["catch"](function(a){e.error(f,"Error during live validation",a)})};
B.prototype.validate=B.prototype.validate;function Wb(a,b){var c=Ib(a._sites);return!b&&c?bc(c._currentRecord.state.createBranch()):bc(new wrm.nav.State(null,a._environ))}function bc(a){a._track=new Ob;return a}B.prototype._retrieveView=function(a,b){var c=Jb(this._sites,a);return c?Cb(c,a,b).getView():null};B.prototype.attachScope=function(a,b,c){var d=Jb(this._sites,a);if(!d)throw Error("No site available for attaching scopes of screen "+a);a=Cb(d,a,b);a.attachScope(c);return a.getView()};
B.prototype.attachScope=B.prototype.attachScope;B.prototype._retrieveFormState=function(a,b){var c=Jb(this._sites,a);return c?Db(c,a,b)._formState:null};
B.prototype.attachModelController=function(a,b,c,d,e){var f=Jb(this._sites,a);if(!f)throw Error("No site available for attaching model controllers of screen "+a);var g=Db(f,a,b);qb(g,c,d,e);return function(){var a=g._modelCtrls[c];if(a&&a===d){if(e&&0>=rb(g,e,-1))for(a=0;a<g._formCtrls.length;a++)if(g._formCtrls[a]===e){g._formCtrls.splice(a,1);break}delete g._modelCtrls[c];delete g._propertyStates[c]}}};B.prototype.attachModelController=B.prototype.attachModelController;
function ac(a,b){a=cc(a,b);if(!a)throw Error("Unable to resolve route "+b);return a}
function cc(a,b){if(b instanceof wrm.nav.ServiceRoute)return b;if(b instanceof wrm.nav.MultipleRoute){a:{b=b.getRoutes();for(var c=0;c<b.length;c++){var d=cc(a,b[c]);if(d){a=d;break a}}a=null}return a}if(b instanceof wrm.nav.VirtualRoute)switch(b.getType()){case wrm.nav.VirtualRoute.Type.BACK:return(b=Lb(a._sites,1))?(a._log.debug("Back route: go to previous site"),a=wrm.nav.Route.toService(b._currentRecord.screenId)):a=null,a;case wrm.nav.VirtualRoute.Type.EXIT:return a._log.debug("Exit route: close application"),
navigator.app.exitApp(),wrm.nav.Route.toNowhere()}return null}B.prototype._handleThrownEvent=function(a){if("SynchronizationSuccess"===a.getType())return this._log.debug("Received background event",a),this._pendingSynchronizationEvent||(this._pendingSynchronizationEvent=a),Promise.resolve();this._log.debug("Received event",a);return Vb(this,a)};function Yb(a,b){Promise.resolve().then(function(){return Promise.all(b.map(function(b){return Vb(a,b)}))})}var dc={BackEvent:!0,HomeEvent:!0};
B.prototype._handleReachedScreen=function(a,b,c){var d=this._sites,e=this._screenSwitcher;this._log.debug(c,"Reached screen",a);var f=c._track,g=c.getCaughtEvent(),g=g&&g.getType(),k=!(!g||!dc[g]),q=f.getReachedFence()||a;Pb(f);var f=!f._fenceChanged,h=!1,C=!1,u=!1,w=Ib(d);k||!b||w&&w.getId()===q?(k&&(h=0<Mb(d,a).length,w=Ib(d),f=!0),w&&w.getId()===q?(this._log.debug(c,"Reusing site",f?"":"(partially)"),w._records[a]&&(c.mergeOnto(w.getState(a)),b=Bb(w,a),u=0<Object.keys(b.attachedViews).length),
C=w.switchTo(a,c),f||Gb(w)):(this._sites.push(new Ab(q,a,c,this._interactor,this._log)),h=!0)):(Nb(this._sites,new Ab(q,a,c,this._interactor,this._log)),h=!0);if(h||C)this._pendingDirectScreenId===a?this._pendingDirectScreenId=null:e.switchTo(a,"AppStartup"===g?"none":k?"backward":"forward");this._pendingSynchronizationEvent=null;return u?wrm.nav.Reuse.FULL:wrm.nav.Reuse.NONE};
B.prototype._handleAddedSite=function(){for(var a=this._sites._sites.length,b=this._viewCacheSize;b<a;b++)Eb(Lb(this._sites,b))};B.prototype._handleRemovedSite=function(a){Eb(a)};B.prototype._retrieveRenderingProvider=function(a){if(!a)return null;var b=Jb(this._sites,a);if(!b)throw Error("Missing site for screen "+a);return Bb(b,a).renderingProvider};function ec(a){return new Rb(a)}B.createTransientRenderingProvider=ec;var E={optimizeForProduction:function(a){a.debugInfoEnabled(!1)}};E.optimizeForProduction.$inject=["$compileProvider"];E.configRouteProvider=function(a){Tb(a,function(a){return"screens/"+a+".html"});a.when("/",{template:""})};E.configRouteProvider.$inject=["$routeProvider"];
E.wrapSanitizationWhitelist=function(a){function b(a){return function(b){if(b){var e=a();e&&e.source&&(b=new RegExp(e.source+"|"+b.source))}return a(b)}}a.aHrefSanitizationWhitelist=b(a.aHrefSanitizationWhitelist);a.imgSrcSanitizationWhitelist=b(a.imgSrcSanitizationWhitelist)};E.wrapSanitizationWhitelist.$inject=["$compileProvider"];
E.setSafeProtocols=function(a,b,c){var d=["file","http","https"];b.split("|").map(function(a){""!==a&&d.push(a)});a.aHrefSanitizationWhitelist(new RegExp("^s*("+d.join("|")+"):"));var e="file http https blob data cdvfile filesystem content".split(" ");c.split("|").map(function(a){""!==a&&e.push(a)});a.imgSrcSanitizationWhitelist(new RegExp("^s*("+e.join("|")+"):"))};E.setSafeProtocols.$inject=["$compileProvider","WRAPP_EXTRA_SAFE_URL_PROTOCOLS","WRAPP_EXTRA_SAFE_IMG_PROTOCOLS"];
E.setFilterDecorators=function(a){a.decorator("dateFilter",Fa);a.decorator("numberFilter",Ga)};E.setFilterDecorators.$inject=["$provide"];var fc={configureWebRatioRuntime:function(){switch(ja()){case "android":wrm.setTempDirectory(cordova.file.externalCacheDirectory);wrm.setPersistentDirectory(cordova.file.dataDirectory);break;case "ios":wrm.setTempDirectory(cordova.file.cacheDirectory);wrm.setPersistentDirectory(cordova.file.dataDirectory);break;case "windows":wrm.setTempDirectory(cordova.file.cacheDirectory);wrm.setPersistentDirectory(cordova.file.dataDirectory);break;default:throw Error("Unsupported platform");}},registerStartupNavigation:function(a,
b,c){var d=null;a.$on("$routeChangeSuccess",function(){var a=b.path();a!==d&&"/"===a&&(d=a,c.notifyStartup())})}};fc.registerStartupNavigation.$inject=["$rootScope","$location","wrRouter"];fc.startEventsHub=function(a){a.start()};fc.startEventsHub.$inject=["wrEventsHub"];fc.publishPlatform=function(a){var b=ja();a.device=a.device||{};a.device.platform=b};fc.publishPlatform.$inject=["$rootScope","wrLogger"];function F(a,b,c,d){this._$scope=a;this._$parse=b;this._l10nManager=c;this._info=gc;this._blobProvider=null;this._log=d.createLog("wr.mvc.BlobController");this._binding=null;a.$on("$destroy",this._disposeInfo.bind(this));this._blobUrlReleaser=new wrm.util.AsyncWorker(function(a){hc(this,a.blob,a.urlPromise||a.url);ic(this,a.blob,a.externalUrlPromise)}.bind(this))}m("wr.mvc.BlobController",F);F.$inject=["$scope","$parse","wrLocalizationManager","wrLogger"];
F.prototype.bind=function(a){if(this._binding)throw Error("Blob controller is already bound");this._binding=a;a.observe(this._handleUpdate.bind(this))};F.prototype.bind=F.prototype.bind;var gc={blob:null,url:null,urlPromise:null,externalUrlPromise:null,status:null};l=F.prototype;
l._handleUpdate=function(a){wrm.data.equal(this._info.blob,a)||(this._disposeInfo(),a?(this._info={blob:a,url:null,urlPromise:null,externalUrlPromise:null,status:a.getMetadata().availabilityStatus},jc(this),n(this._$scope)):this._info=gc,jc(this))};l._disposeInfo=function(){this._blobUrlReleaser.post(this._info);this._info=gc};
function kc(a){var b=a._info;!b.blob||b.url||b.urlPromise||b.status!==wrm.data.AvailabilityStatus.AVAILABLE||(b.urlPromise=lc(a,b.blob),b.urlPromise.then(function(c){a._info===b&&(b.url=c,b.urlPromise=null,jc(a),n(a._$scope))}))}
function jc(a){var b=a._info,c={};Object.defineProperty(c,"url",{get:function(){b.url||kc(a);return b.url}});c.loading=!b.url&&!!b.blob||b.status===wrm.data.AvailabilityStatus.PENDING;c.failed=b.status===wrm.data.AvailabilityStatus.FAILED;c.clear=a._clear.bind(a);c.capture=a._captureNew.bind(a);c.select=a._selectNew.bind(a);c.open=a._open.bind(a);a._$scope.blob=c}l._clear=function(){mc(this).assign(null)};l._captureNew=function(a,b){var c=mc(this);nc(this).capture(a,b).then(function(a){c.assign(a)})};
l._selectNew=function(a,b){var c=mc(this);nc(this).select(a,b).then(function(a){c.assign(a)})};function nc(a){a._blobProvider||(a._blobProvider=$a(wrm.data.Type.BLOB));return a._blobProvider}function mc(a){a=a._binding;if(!a||!a.isAssignable())throw Error("Not bound to an asisgnable model expression");return a}
l._open=function(a){var b=this._l10nManager,c=this._log,d=this._info;if(d.blob){d.externalUrlPromise||(d.externalUrlPromise=oc(this,d.blob));var e=a||d.blob.getContentType()||"application/octet-stream",f=d.blob?d.blob.getUniqueId():"?";d.externalUrlPromise.then(function(a){ab(a,e).then(function(){c.debug("Opened viewer for BLOB",f)},function(a){c.error("Error opening viewer for BLOB",f,a);a=b.formatMessage("dialog.title.error");var d=b.formatMessage("notification.blobOpenError"),e=b.formatMessage("dialog.button.OK");
Va(d,a,e)})})}};function lc(a,b){var c=a._log,d=b.getUniqueId();c.debug("Allocating internal URL for BLOB",d);return b.createObjectURL().then(function(a){c.isDebugEnabled()&&c.debug("Allocated internal URL for BLOB",d,":",80<a.length?a.substring(0,80)+"...":a);return a},function(a){c.error("Error allocating internal URL for BLOB",d,a);throw a;})}
function hc(a,b,c){var d=a._log,e=b?b.getUniqueId():"?";c&&Promise.resolve(c).then(function(a){b.revokeObjectURL(a);d.debug("Released internal URL for BLOB",e)})}function oc(a,b){var c=a._log,d=b.getUniqueId();c.debug("Allocating external URL for BLOB",d);return b.createExternalURL().then(function(a){c.isDebugEnabled()&&c.debug("Allocated external URL for BLOB",d,":",80<a.length?a.substring(0,80)+"...":a);return a},function(a){c.error("Error allocating external URL for BLOB",d,a);throw a;})}
function ic(a,b,c){var d=a._log,e=b?b.getUniqueId():"?";c&&c.then(function(a){b.revokeExternalURL(a).then(function(){d.debug("Released external URL for BLOB",e)},function(a){d.error("Error releasing external URL for BLOB",e,a)})})};function pc(a){return{scope:!0,require:["wrBlob","?ngModel"],restrict:"A",controller:F,link:function(b,c,d,e){c=e[0];e=e[1];if(d=d.wrBlob)b=a.createExpressionBinding(b,d);else if(e)b=a.createModelControllerBinding(b,e);else throw Error("The wrBlob directive requires an expression or the ngModel directive");c.bind(b)}}}m("wr.mvc.blobDirective",pc);pc.$inject=["wrModelBinder"];function qc(){return ia({require:"^wrScreen",scope:!0,link:{pre:function(a,b,c,d){c=c.wrComponent;if(!c)throw Error("No component id specified for wrComponent");d=rc(d,c,a);a.view=d;a.$watch("view.updating",function(a){a?b.addClass("wr-view-updating"):b.removeClass("wr-view-updating")});a.$watch("view._updatingBG",function(a){a?b.addClass("wr-view-updating-bg"):b.removeClass("wr-view-updating-bg")})}}})}m("wr.mvc.componentDirective",qc);function sc(a,b,c){var d=a.wrEval;if(!d)throw Error("No eval expression specified(wr-eval)");b.$watch(d,function(e){void 0!=e&&(e=function(a){return a.replace(/[-_ .]+(.)?/g,function(a,b){return b?b.toUpperCase():""}).replace(/[^\w]/gi,"")}(e),e=a["expr"+e],void 0==e&&(e=a.exprdefault),void 0!=e&&(b.$eval(e),c(d).assign(b,null)))})}m("wr.mvc.EvalController",sc);sc.$inject=["$attrs","$scope","$parse","wrRouter","wrLogger"];function tc(){return{scope:!0,restrict:"A",controller:sc}}m("wr.mvc.evalDirective",tc);function G(a,b,c){this._$document=a;this._router=c;this._started=!1;this._backUnbindFn=this._backNotifier=null}m("wr.mvc.EventsHub",G);G.$inject=["$document","$injector","wrRouter"];G.prototype.start=function(){if(this._started)throw Error("Already started");this._started=!0;uc(this,"resume","AppResume");this._backNotifier||(this._backUnbindFn=uc(this,"backbutton","BackEvent",!0))};G.prototype.start=G.prototype.start;
G.prototype.overrideBackButtonNotification=function(){if(this._backNotifier)throw Error("Back button notification is already overridden");this._backUnbindFn();this._backUnbindFn=null;this._backNotifier=vc(this);return this._backNotifier.notify};G.prototype.overrideBackButtonNotification=G.prototype.overrideBackButtonNotification;
G.prototype.restoreBackButtonNotification=function(){this._backUnbindFn||(this._backNotifier.disable(),this._backNotifier=null,this._backUnbindFn=uc(this,"backbutton","BackEvent",!0))};G.prototype.restoreBackButtonNotification=G.prototype.restoreBackButtonNotification;function uc(a,b,c,d){function e(a){d&&a.preventDefault();f._router.notifyEvent(c)}var f=a,g=a._$document[0];g.addEventListener(b,e);return function(){g.removeEventListener(b,e)}}
function vc(a){var b=!1;return{notify:function(){if(b)throw Error("Event notifier has been disabled");a._router.notifyEvent("BackEvent")},disable:function(){b=!0}}};function H(a,b,c,d,e,f){this._$scope=c;this._$element=a;this._router=e;this._$animate=d;this._hooks=null;this._log=f.createLog("wr.mvc.FeedbackController");wc(this)}m("wr.mvc.FeedbackController",H);H.$inject="$element $attrs $scope $animate wrRouter wrLogger".split(" ");function wc(a){var b=a._$scope,c=Ia(a);a._hooks=c;var d=b.$on("$destory",function(){d();c.detachController()})}function Ma(a,b){var c=a._$scope;n(c,function(){c.feedback.data=b})}
function Oa(a){var b=a._$scope,c=a._$animate,d=a._$element.children();return new Promise(function(a){n(b,function(){c.leave(d).then(function(){n(b,function(){delete b.feedback.data;a(void 0)})})})})}H.prototype.close=function(a){return this.throwEvent(a,"Close")};H.prototype.close=H.prototype.close;
H.prototype.throwEvent=function(a,b,c,d){var e=this._log;a.stopPropagation();e.isDebugEnabled()&&e.debug("Throwing feedback event",b+" "+JSON.stringify(d||{}));return this._hooks.throwEvent(b,d).then(void 0,function(a){e.error("Error during feedback event handling",a)})};H.prototype.throwEvent=H.prototype.throwEvent;function xc(){return ia({scope:!0,controller:H,controllerAs:"feedback"})}m("wr.mvc.feedbackDirective",xc);function yc(a){var b=wrm.data.Type,c={date:b.DATE,"datetime-local":b.TIMESTAMP,number:b.FLOAT,time:b.TIME};return{require:"ngModel",restrict:"A",link:function(d,e,f,g){d=wrm.util.obj.castEnumValue(b,f.wrInputFormat||c[f.type]);zc(a,e,d,g)}}}m("wr.mvc.inputFormatDirective",yc);yc.$inject=["wrInputFormatter","wrLogger"];function Ac(a,b){function c(b,c){for(var f=[],g=-1,k=0,q=0;q<b.length;q++){var h=b.charAt(q);"("===h?k++:")"===h?k--:"."===h&&0===k&&(f.push(b.substring(g+1,q)),g=q)}f.push(b.substring(g+1));for(g=1;g<=f.length;g++)if((k=a(f.slice(0,g).join("."))(c))&&k.componentId)return{componentId:k.componentId,expr:f.slice(g).join(".")};throw Error("The ng-model expression does not reference a view: "+b);}return{require:["^wrScreen","ngModel","^?form"],restrict:"A",link:function(a,e,f,g){function k(){delete h.$asyncValidators.wrValidation;
D()}var q=g[0],h=g[1];g=g[2];var C=c(f.ngModel,a),u=C.componentId,w=q.getFormInfo().resolvePropertyFromView(u,C.expr),C=q.getFormInfo().getPropertyType(u,w);f.hasOwnProperty("wrInputFormat")||zc(b,e,C,h);var D=q.attachModelController(u,w,h,g);h.$asyncValidators.wrValidation=function(){if(h.$pristine)return Promise.resolve();var a=q.validate(u,w);if(a)return a.then(function(a){if(!a)throw Error();},function(){return!0})};C===wrm.data.Type.URL&&delete h.$validators.url;e.on("$destroy",k);a.$on("$destroy",
k)}}}m("wr.mvc.formPropertyDirective",Ac);Ac.$inject=["$parse","wrInputFormatter","wrRouter","wrLogger"];function I(a,b){function c(a){if(null===a||void 0===a||angular.isDate(a))return a;if(a instanceof wrm.data.Date||a instanceof wrm.data.Time||a instanceof wrm.data.DateTime)return a.asDate();e.warn("Value not convertible to Date",a);return null}var d=wrm.data.Type,e=b.createLog("wr.mvc.InputFormatter");this._defaultFormatter={toModel:function(a){return a},toView:function(a){return a}};this._formatters={};this._formatters[d.DATE]={toModel:function(a){return"string"===typeof a&&a?wrm.data.Date.fromString(a):
null},toView:function(b){return a("date")(c(b),"yyyy-MM-dd")}};this._formatters[d.TIME]={toModel:function(a){return"string"===typeof a&&a?wrm.data.Time.fromString(a):null},toView:function(b){return a("date")(c(b),"HH:mm:ss")}};this._formatters[d.TIMESTAMP]={toModel:function(a){return"string"===typeof a&&a?wrm.data.DateTime.fromString(a):null},toView:function(b){return a("date")(c(b),"yyyy-MM-dd'T'HH:mm:ss")}};this._formatters[d.DECIMAL]={toModel:function(a){return"string"===typeof a?wrm.data.toDecimal(a):
null},toView:function(a){return a instanceof wrm.data.Decimal?a.toString():a}};this._formatters[d.INTEGER]={toModel:function(a){return"string"===typeof a?wrm.data.toInteger(a):null},toView:function(a){return a}};this._formatters[d.FLOAT]={toModel:function(a){return"string"===typeof a?wrm.data.toFloat(a):null},toView:function(a){return a}};this._validatorsPatchers={};this._validatorsPatchers[d.DATE]=function(a){if(a.min){var b=a.min;a.min=function(a){return b.call(void 0,a?a.asDate():void 0)}}if(a.max){var c=
a.max;a.max=function(a){return c.call(void 0,a?a.asDate():void 0)}}};this._validatorsPatchers[d.TIME]=function(a){if(a.min){var b=a.min;a.min=function(a){return b.call(void 0,a?a.asDate():void 0)}}if(a.max){var c=a.max;a.max=function(a){return c.call(void 0,a?a.asDate():void 0)}}};this._validatorsPatchers[d.TIMESTAMP]=function(a){if(a.min){var b=a.min;a.min=function(a){return b.call(void 0,a?a.asDate():void 0)}}if(a.max){var c=a.max;a.max=function(a){return c.call(void 0,a?a.asDate():void 0)}}}}
m("wr.mvc.InputFormatter",I);I.$inject=["$filter","wrLogger"];I.prototype.getFormatter=function(a){return this._formatters[a]||this._defaultFormatter};I.prototype.getFormatter=I.prototype.getFormatter;I.prototype.patchValidators=function(a,b){if(this._validatorsPatchers[a])this._validatorsPatchers[a](b)};I.prototype.patchValidators=I.prototype.patchValidators;
function zc(a,b,c,d){var e=a.getFormatter(c),f=[];null!==b[0].validity&&"object"===typeof b[0].validity&&f.push(function(a){var c=b[0].validity||{};return c.badInput&&!c.typeMismatch?void 0:a});f.push(function(a){try{return e.toModel(a)}catch(b){}});d.$$parserName=ga[c];d.$parsers=f;d.$formatters=[function(a){return e.toView(a)}];a.patchValidators(c,d.$validators)};function Bc(a,b,c,d,e){this._$log=b?a:null;this._dbLogEnabled=c;this._timestampFormat=d;this._maxArgLength=e}m("wr.mvc.Logger",Bc);Bc.$inject=["$log","WRAPP_LOG_ENABLED","WRAPP_LOG_DB_ENABLED","WRAPP_LOG_TIMESTAMP","WRAPP_LOG_MAX_ARG_LENGTH"];Bc.prototype.createLog=function(a,b){if(!this._$log||!this._dbLogEnabled&&"database"===a)return Cc;var c=Array.prototype.slice.call(arguments,0);c.shift();return new Dc(this._$log,this._timestampFormat,a,c,this._maxArgLength)};Bc.prototype.createLog=Bc.prototype.createLog;
var Cc={error:angular.noop,warn:angular.noop,info:angular.noop,debug:angular.noop,isDebugEnabled:function(){return!1}};function Dc(a,b,c,d,e){this.error=Ec(a,a.error,"ERROR",b,c,d,e);this.warn=Ec(a,a.warn,"WARN",b,c,d,e);this.info=Ec(a,a.info,"INFO",b,c,d,e);this.debug=Ec(a,a.debug,"DEBUG",b,c,d,e);this.isDebugEnabled=function(){return!0}}
function Ec(a,b,c,d,e,f,g){var k="long"===d,q="long"===d||"short"===d,h=c+" ["+e+"]",C=b.bind(a);return function(){var a=new Date,b=[];k&&(b.push(a.getFullYear()),b.push("-"),b.push(("00"+(a.getMonth()+1)).slice(-2)),b.push("-"),b.push(("00"+a.getDate()).slice(-2)),b.push(" "));q&&(b.push(("00"+a.getHours()).slice(-2)),b.push(":"),b.push(("00"+a.getMinutes()).slice(-2)),b.push(":"),b.push(("00"+a.getSeconds()).slice(-2)),b.push("."),b.push(("000"+a.getMilliseconds()).slice(-3)),b.push(" "));b.push(h);
a=Array.prototype.slice.call(arguments,0);Array.prototype.unshift.apply(a,f);a.unshift(b.join(""));Fc.post({fn:C,message:Gc(a,g)})}}
function Gc(a,b){function c(a){if("object"!==typeof a||null===a)return d(String(a));if(a instanceof Error)return a.stack?a.stack:a.message?a.name+": "+a.message:a.name;try{return d(jsDump.parse(a))}catch(b){return"[Error dumping object: "+String(b)+"]"}}function d(a){if(!a||a.length<=b)return a;var c=a.substring(0,b/3*2),d=0<=a.indexOf("\n")?"\n":"";return c+d+"[..."+(a.length-b)+" omitted...]"+d+a.substring(a.length-(b-c.length),a.length)}for(var e="",f=0;f<a.length;f++)0<f&&(e+=" "),e+=c(a[f]);
return e}var Fc=new wrm.util.AsyncWorker(function(a){a.fn(a.message)});(function(){var a=Object.prototype.toString,b=jsDump.parsers.object;jsDump.setParser("object",function(c){return c&&c.toString!==a?c.toString():b.apply(this,arguments)})})();function J(a){this._platform=a}m("wr.mvc.impl.FileDescriptorLoader",J);J.prototype.loadConfigurationObject=function(a){return this._platform.readAppFile("conf/"+a+".json")};J.prototype.loadConfigurationObject=J.prototype.loadConfigurationObject;
J.prototype.loadConfigurationProperties=function(a){return this._platform.readAppFile("conf/"+a+".properties",!0).then(function(a){var c;if(a){c=Hc;a=new Uint8Array(a);for(var d=Array(a.byteLength),e=0;e<d.length;e++)d[e]=a[e];c=c(String.fromCharCode.apply(null,d))}else c=null;return c})};J.prototype.loadConfigurationProperties=J.prototype.loadConfigurationProperties;
function Hc(a){function b(a){return a.replace(/\\(u[0-9A-Fa-f]{4}|.)/g,function(a,b){switch(b[0]){case "u":return String.fromCharCode(parseInt(b.slice(1),16));case "t":return"\t";case "n":return"\n";case "f":return"\f";case "r":return"\r";default:return b}})}var c={};a=a.replace(/^[ \t\f]*(.*)$/gm,"$1");a=a.replace(/^((?:.*[^\\])?(?:\\\\)*)\\(?:\r\n|[\r\n])/gm,"$1");for(var d=/^[^\s#!].*$/gm,e=/^(.*?[^\\])(?:[=:]\s*|\s+(?:[=:]\s*)?)(.+)?$/,f,g;f=d.exec(a);)g=e.exec(f[0]),f=b(g[1]),g=b(g[2]||""),c[f]=
g;return c}J.prototype.loadServiceDescriptor=function(a){return this._platform.readAppFile("services/"+a+".json")};J.prototype.loadServiceDescriptor=J.prototype.loadServiceDescriptor;function K(a,b,c,d,e,f){this._networkTimeout=a;this._$http=b;this._notificationManager=c;this._localizationManager=d;this._storage=e;this._logger=f;this._log=f.createLog("wr.mvc.impl.NgPlatform")}m("wr.mvc.impl.NgPlatform",K);K.$inject="WRAPP_NETWORK_TIMEOUT $http wrNotificationManager wrLocalizationManager wrStorage wrLogger".split(" ");K.prototype.getDeviceId=function(){return device.uuid};K.prototype.getDeviceId=K.prototype.getDeviceId;K.prototype.getDeviceModel=function(){return device.model};
K.prototype.getDeviceModel=K.prototype.getDeviceModel;K.prototype.getDevicePlatform=function(){return device.platform};K.prototype.getDevicePlatform=K.prototype.getDevicePlatform;K.prototype.getDevicePlatformVersion=function(){return device.version};K.prototype.getDevicePlatformVersion=K.prototype.getDevicePlatformVersion;K.prototype.getWebEngineType=function(){return GLOBAL.navigator.userAgent};K.prototype.getWebEngineType=K.prototype.getWebEngineType;
K.prototype.createLog=function(a){return this._logger.createLog.apply(this._logger,arguments)};K.prototype.createLog=K.prototype.createLog;K.prototype.retrieveDictionary=function(a){return this._storage.getDictionary("mgr|"+a)};K.prototype.retrieveDictionary=K.prototype.retrieveDictionary;
K.prototype.readAppFile=function(a,b){var c=this,d=this._$http,e={method:"GET",url:a};b&&(e.responseType="arraybuffer");return d(e).then(function(a){var b=c._log;a=a.data;if("string"===typeof a){for(var d=!1,e=[],h=0;h<a.length;h++){var C=a.charCodeAt(h);255<C&&(d=!0);e.push(C)}d&&b.warn("Possible encoding errors in last loaded app file");a=(new Uint8Array(e)).buffer}return a},function(b){switch(b.status){case 404:case 500:case 0:case -1:return!1}throw Error("Error loading file '"+a+"' - "+b.status+
" ("+b.statusText+")");})};K.prototype.readAppFile=K.prototype.readAppFile;K.prototype.makeHttpRequest=function(a){var b=this._$http;a=Ic(this,a);return new Promise(function(c,d){b(a).then(c,d)})};K.prototype.makeHttpRequest=K.prototype.makeHttpRequest;function Ic(a,b){void 0===b.timeout&&(b.timeout=a._networkTimeout);return b}K.prototype.getNotificationDeviceId=function(){return this._notificationManager.getDeviceId()};K.prototype.getNotificationDeviceId=K.prototype.getNotificationDeviceId;
K.prototype.hasPendingNotifications=function(){return this._notificationManager.hasPendingNotifications()};K.prototype.hasPendingNotifications=K.prototype.hasPendingNotifications;K.prototype.addNotificationStatusListener=function(a){this._notificationManager.addSubscriptionListener(a)};K.prototype.addNotificationStatusListener=K.prototype.addNotificationStatusListener;
K.prototype.subscribeNotifications=function(a,b){function c(a){b({title:a._title,message:a.getMessage(),parameters:a.getParameters()})}return this._notificationManager.register(a,function(a){if(a._foreground)return Za({title:a._title,message:a.getMessage()},7E3,{Accept:function(){c(a)}});c(a)})};K.prototype.subscribeNotifications=K.prototype.subscribeNotifications;K.prototype.getCurrentLocale=function(){return this._localizationManager.getCurrentLocale()};K.prototype.getCurrentLocale=K.prototype.getCurrentLocale;
K.prototype.getCurrentLocaleInfo=function(){return this._localizationManager.getLocaleInfo()};K.prototype.getCurrentLocaleInfo=K.prototype.getCurrentLocaleInfo;K.prototype.overrideLocale=function(a){return this._localizationManager.overrideLocale(a)};K.prototype.overrideLocale=K.prototype.overrideLocale;function Jc(a){return new wrm.core.Manager(new J(a),a)}m("wr.mvc.managerFactory",Jc);Jc.$inject=["wrNgPlatform"];function L(a){this._$parse=a}m("wr.mvc.ModelHelper",L);L.$inject=["$parse"];L.prototype.createExpressionBinding=function(a,b){return new Kc(a,b,this._$parse(b))};L.prototype.createExpressionBinding=L.prototype.createExpressionBinding;L.prototype.createModelControllerBinding=function(a,b){return new Lc(a,b)};L.prototype.createModelControllerBinding=L.prototype.createModelControllerBinding;function N(){}L.Binding=N;N.prototype.observe=aa;N.prototype.observe=N.prototype.observe;
N.prototype.isAssignable=aa;N.prototype.isAssignable=N.prototype.isAssignable;N.prototype.assign=aa;N.prototype.assign=N.prototype.assign;function Kc(a,b,c){this._scope=a;this._expression=b;this._parsedExpression=c}Kc.prototype.observe=function(a){this._scope.$watch(this._expression,a)};Kc.prototype.isAssignable=function(){return!!this._parsedExpression.assign};Kc.prototype.assign=function(a){this._parsedExpression.assign(this._scope,a);n(this._scope)};
function Lc(a,b){this._scope=a;this._modelCtrl=b}Lc.prototype.observe=function(a){var b=this._modelCtrl;b.$render=function(){a(b.$viewValue)}};Lc.prototype.isAssignable=function(){return!0};Lc.prototype.assign=function(a){var b=this._modelCtrl;n(this._scope,function(){b.$setViewValue(a);b.$render()})};function O(a,b,c,d){a=b.wrScreen;if(!a)throw Error("No screen id specified for wrScreen");this.id=a;this._$scope=c;this._router=d;this._unscopedComponentViews={}}m("wr.mvc.ScreenController",O);O.$inject=["$element","$attrs","$scope","wrRouter"];O.prototype.getFormInfo=function(){return this._router.getFormInfo(this.id)};O.prototype.getComponentView=function(a){var b=this._$scope,c=this._unscopedComponentViews,d=c[a];if(!d){d=rc(this,a,b);c[a]=d;var e=b.$on("$destroy",function(){e();delete c[a]})}return d};
O.prototype.getComponentView=O.prototype.getComponentView;function rc(a,b,c){a=a._router.attachScope(a.id,b,c);a.componentId||Object.defineProperty(a,"componentId",{value:b});return a}O.prototype.attachModelController=function(a,b,c,d){return this._router.attachModelController(this.id,a,b,c,d)};O.prototype.validate=function(a,b){return this._router.validate(this.id,a,b)};
O.prototype.throwEvent=function(a,b,c,d){if(a){var e=a.target.ownerDocument.activeElement;e&&/input|select|textarea|button|object/i.test(e.tagName)&&a.target!==e&&e.blur()}return this._router.notifyUserEvent(b,c,d)};O.prototype.throwEvent=O.prototype.throwEvent;function Mc(){return ia({scope:!0,controller:O,controllerAs:"screen"})}m("wr.mvc.screenDirective",Mc);function P(a,b,c,d){this._foreground=a;this._title=b;this._message=c;this._parameters=d}m("wr.mvc.Notification",P);P.prototype.isForeground=function(){return this._foreground};P.prototype.isForeground=P.prototype.isForeground;P.prototype.getTitle=function(){return this._title};P.prototype.getTitle=P.prototype.getTitle;P.prototype.getMessage=function(){return this._message};P.prototype.getMessage=P.prototype.getMessage;P.prototype.getParameters=function(){return this._parameters};
P.prototype.getParameters=P.prototype.getParameters;P.prototype.toString=function(){return""+this._title+" ("+(this._foreground?"foreground":"background")+")"};P.prototype.toString=P.prototype.toString;function Q(a,b){this._senderId=a;this._subscribePromise=this._deviceId=null;this._subscriptionListeners=new wrm.util.ListenerList;this._handlers={};this._queues={};this._log=b.createLog("wr.mvc.NotificationManager");GLOBAL.setTimeout(this._stopQueuing.bind(this),6E4)}m("wr.mvc.NotificationManager",Q);Q.$inject=["WRAPP_NOTIFICATIONS_SENDER_ID","wrLogger"];Q.PARAMETER_PREFIX="wr-";Q.CUSTOM_PARAMETER_PREFIX="p-";
Q.prototype.getDeviceId=function(){var a=this._deviceId;a&&0===a.indexOf("private:")&&(a=null);return Promise.resolve(a)};Q.prototype.getDeviceId=Q.prototype.getDeviceId;Q.prototype._setDeviceId=function(a){this._deviceId=a;this._subscriptionListeners.notifyAll(this._deviceId)};Q.prototype.addSubscriptionListener=function(a){this._subscriptionListeners.add(a)};Q.prototype.addSubscriptionListener=Q.prototype.addSubscriptionListener;Q.prototype.removeSubscriptionListener=function(a){this._subscriptionListeners.remove(a)};
Q.prototype.removeSubscriptionListener=Q.prototype.removeSubscriptionListener;Q.prototype.hasPendingNotifications=function(){return new Promise(function(a,b){return GLOBAL.PushNotification.hasColdStartNotification(function(b){a(!0===b)},function(a){b(Error(a))})})};Q.prototype.hasPendingNotifications=Q.prototype.hasPendingNotifications;
Q.prototype.register=function(a,b){var c=this,d=this._handlers;return Promise.resolve().then(function(){var a;if(c._subscribePromise)a=c._subscribePromise;else{var b=wrm.util.newPromiseCallbackAdapter();b.promise.then(c._setDeviceId.bind(c));a=Nc;var d=c._handleRawNotification.bind(c),b=b.callback,k={};switch(ja()){case "android":var q=c._senderId;if(!q)throw Error("Notification sender id not available");k.android={senderID:q};break;case "ios":k.ios={alert:!0,badge:!0,sound:!0};break;case "windows":k.windows=
{silentForeground:!0};break;default:throw Error("Unsupported platform "+ja());}a=a(c,d,b,k);c._subscribePromise=a}return a}).then(function(){if(d[a])throw Error("Handler already registered for '"+a+"' notifications");d[a]=b;c._dumpQueue(a)})};Q.prototype.register=Q.prototype.register;Q.prototype.unregister=function(a){var b=this._handlers;return b.hasOwnProperty(a)?(delete b[a],!0):!1};Q.prototype.unregister=Q.prototype.unregister;
function Nc(a,b,c,d){var e=Oc,f=Pc,g=a._log;return new Promise(function(a){var q=GLOBAL.PushNotification.init(d);g.debug("Sent registration request");q.on("registration",function(a){g.debug("Received registration");c(a.registrationId)});q.on("notification",function(a){g.debug("Received message");var c=a.additionalData,d;d=c.foreground?e.INLINE:c.coldstart?e.COLDSTART:e.BACKGROUND;var k=a.title||"";a=a.message||"";c=Qc(c);b(new f(d,k,a,c))});q.on("error",function(a){a.message===PushNotification.ErrorCode.NOTALLOWED?
c(null):g.error("Received error: ",a)});a()})}function Qc(a){var b={};Object.keys(a).forEach(function(c){0===c.indexOf("wr-")&&(b[c.substring(3)]=a[c])});return b}Q.prototype._handleRawNotification=function(a){var b=Oc,c=this._log,d=a.payload,e=d.name,f={};Object.keys(d).forEach(function(a){0===a.indexOf("p-")&&(f[a.substring(2)]=d[a])});e?this.triggerNotification(e,new P(a.mode===b.INLINE,a.title,a.message,f)):c.warn("Ignoring foreign notification",a)};
Q.prototype.triggerNotification=function(a,b){var c=this,d=this._queues;if(!this._handlers[a]&&d){var e=d[a];e||(d[a]=e=[]);return new Promise(function(a,c){e.push({notification:b,resolve:a,reject:c})})}return new Promise(function(d){Rc(c,a,b,d)})};Q.prototype.triggerNotification=Q.prototype.triggerNotification;
function Rc(a,b,c,d){var e=a._log;e.debug("Received",b,"notification:",c);var f=a._handlers[b];f?d(Promise.resolve().then(function(){return f(c)})):(e.debug("No handler registered: ignoring"),d(void 0))}Q.prototype._dumpQueue=function(a){var b=this,c=this._queues,d=c&&c[a];d&&(delete c[a],d.forEach(function(c){GLOBAL.setTimeout(function(){Rc(b,a,c.notification,c.resolve)},0)}))};
Q.prototype._stopQueuing=function(){this._queues&&(Object.keys(this._queues).forEach(this._dumpQueue,this),this._queues=null)};var Oc={COLDSTART:"COLDSTART",BACKGROUND:"BACKGROUND",INLINE:"INLINE"};function Pc(a,b,c,d){this.mode=a;this.title=b;this.message=c;this.payload=d}Pc.prototype.toString=function(){return""+this.mode+" notification { title: "+this.title+", message: "+this.message+", payload: "+JSON.stringify(this.payload)+"}"};function Sc(a,b,c,d){d=d.createLog("wr.mvc.viewDirective");var e=ec(d),f=new z("none");return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(d,k,q,h,C){function u(a){var b=GLOBAL.requestAnimationFrame||GLOBAL.webkitRequestAnimationFrame,c;u=c="function"===typeof b?function(a){return b.call(GLOBAL,a)}:function(a){return GLOBAL.setTimeout(a,16)};return c(a)}function w(a){da&&(da.cancel(),da=null);ea&&(ea.release(function(b){wb(b).$broadcast("wrViewLeaving");da=M(b.getElement(),
{initialParkingClassName:"wr-view-present",className:"wr-view-leave",switchClassName:a,finalParkingClassName:"wr-view-away"});da.then(function(){da=null})}),ea=null)}function D(){var h=a.current&&a.current.locals,q=h&&h.wrRenderingProvider||e,u="wr-switch-"+(h&&h.wrSwitchInfo||f)._direction;angular.isDefined(h&&h.$template)?(ea=h=q.retrieve(function(a){wb(a).$broadcast("wrViewEntering");var e=ea?ea.getElement():k,f=a.getElement(),h=c.enabled();c.enabled(!1);M(f,{domSetup:function(){f[0].parentNode||
e.after(f)},initialParkingClassName:"wr-view-away",className:"wr-view-enter",switchClassName:u,finalParkingClassName:"wr-view-present"}).then(function(){c.enabled(h);!angular.isDefined(Xa)||Xa&&!d.$eval(Xa)||b()});w(u)},function(a){var b=d.$new();C(b,function(c){a({scope:b,element:c})})}),h=wb(h),a.current.scope=h,h.$emit("$viewContentLoaded"),h.$eval(ed)):w(u)}function M(a,b){function c(){e||(e=!0,b.finalParkingClassName&&a.addClass(b.finalParkingClassName),a.removeClass(b.className+" "+b.switchClassName+
" "+b.className+"-active"),d&&d())}var d=null,e=!1,f=new Promise(function(f){d=f;u(function(){e||(b.domSetup&&b.domSetup(),a.addClass(b.className).addClass(b.switchClassName),b.initialParkingClassName&&a.removeClass(b.initialParkingClassName));u(function(){R(a,b.className+"-active",c)})})});f.cancel=c;return f}function R(a,b,c){a.addClass(b);var d=(new Date).valueOf();u(function(){function b(a){a.stopPropagation();a=a.originalEvent||a;var c=a.timeStamp||(new Date).valueOf();a=parseFloat(a.elapsedTime.toFixed(3));
Math.max(c-d,0)>=f.delay&&a>=f.duration&&e()}function e(){g||(g=!0,a.off("transitionend webkitTransitionEnd",b),h&&GLOBAL.clearTimeout(h),c())}var f=fd(a);if(0===f.duration)c();else{var g=!1;a.on("transitionend webkitTransitionEnd",b);var h=GLOBAL.setTimeout(e,f.duration)}})}function fd(a){function b(a){var c=0;a="string"===typeof a?a.split(/\s*,\s*/):[];for(var d=0;d<a.length;d++)c=Math.max(parseFloat(a[d])||0,c);return c}a=GLOBAL.getComputedStyle(a[0])||{};return{duration:1E3*b(a["transition-duration"]||
a["-webkit-transition-duration"]),delay:1E3*b(a["transition-delay"]||a["-webkit-transition-delay"])}}var ea=null,da=null,Xa=q.autoscroll,ed=q.onload||"";d.$on("$routeChangeSuccess",D);D()}}}m("wr.mvc.viewDirective",Sc);Sc.$inject=["$route","$anchorScroll","$animate","wrLogger"];
Sc.auxiliaryDirective=function(a,b,c){return{restrict:"ECA",priority:-400,link:function(d,e){var f=c.current,g=f.locals;e.html(g.$template);var k=a(e.contents());f.controller&&(g.$scope=d,g=b(f.controller,g),f.controllerAs&&(d[f.controllerAs]=g),e.data("$ngControllerController",g),e.children().data("$ngControllerController",g));k(d)}}};Sc.auxiliaryDirective.$inject=["$compile","$controller","$route"];function S(a){this._prefix=a;this._localStorage=GLOBAL.localStorage;if(!this._localStorage)throw Error("Local storage not supported");}m("wr.mvc.impl.Storage",S);S.$inject=["WRAPP_STORAGE_PREFIX"];S.prototype.getDictionary=function(a){return new Tc(this._localStorage,this._prefix+a+"|")};S.prototype.getDictionary=S.prototype.getDictionary;
S.prototype.clearAllDictionaries=function(){for(var a=[],b=0;b<this._localStorage.length;b++){var c=this._localStorage.key(b);0===c.indexOf(this._prefix)&&a.push(c)}a.forEach(function(a){this._localStorage.removeItem(a)},this)};S.prototype.clearAllDictionaries=S.prototype.clearAllDictionaries;function Tc(a,b){this._localStorage=a;this._keyPrefix=b}l=Tc.prototype;
l.getKeys=function(){for(var a=[],b=this._localStorage.length,c=0;c<b;c++){var d=this._localStorage.key(c);0===d.indexOf(this._keyPrefix)&&a.push(d.substring(this._keyPrefix.length))}return a};l.get=function(a){a=this._localStorage.getItem(this._keyPrefix+a);return null!==a&&void 0!==a?a:null};l.set=function(a,b){this._localStorage.setItem(this._keyPrefix+a,b)};l.remove=function(a){this._localStorage.removeItem(this._keyPrefix+a)};
l.clear=function(){this.getKeys().forEach(function(a){this.remove(a)},this)};function Uc(a){function b(b){return a._l10nService&&a._defaultFormatters?a.formatMessage(b):b}b.$stateful=!0;return b}m("wr.mvc.l10n.localizeFilter",Uc);Uc.$inject=["wrLocalizationManager"];var Vc=function(){var a=angular.module("wr.mvc.App",["wr.mvc.App.CONFIG","ngRoute"]);angular.forEach(E,function(b){a.config(b)});angular.forEach(fc,function(b){a.run(b)});a.directive("wrComponent",qc);a.directive("wrBlob",pc);a.directive("wrEval",tc);a.directive("wrFeedback",xc);a.directive("wrFormProperty",Ac);a.directive("wrInputFormat",yc);a.directive("wrScreen",Mc);a.directive("wrView",Sc);a.directive("wrView",Sc.auxiliaryDirective);a.filter("wrLocalize",Uc);a.service("wrEventsHub",G);a.service("wrInputFormatter",
I);a.service("wrLogger",Bc);a.factory("wrManager",Jc);a.service("wrModelBinder",L);a.service("wrLocalizationManager",v);a.service("wrNotificationManager",Q);a.service("wrNgPlatform",K);a.service("wrRouter",B);a.service("wrStorage",S);return a}();m("wr.mvc.App",Vc);function pa(a,b){a=a.main([]);var c={main:{}};c.main[b]=angular.copy(a);this._data=new wrm.util.ObjectMapper(c);this._pathPrefix=["main",b]}pa.prototype.getData=function(){return this._data.getObject()||{}};function t(a,b,c){a._data.setValue(a._pathPrefix.concat(b),c)}function qa(a,b,c){var d={};c.forEach(function(a,b){d[String(b+1)]=a});b=p[b];t(a,["dates","calendars","gregorian","months","format",b],d);t(a,["dates","calendars","gregorian","months","stand-alone",b],d)}
function ra(a,b,c){var d={};na.forEach(function(a,b){d[a]=c[b]});b=r[b];t(a,["dates","calendars","gregorian","days","format",b],d);t(a,["dates","calendars","gregorian","days","stand-alone",b],d)};var Wc=function(){var a=angular.module("wr.mvc.mgmt.AppManagement",[]);a.provider("wrAppManagementConfig",function(){var a={};return{set:function(c){a=c||{}},$get:function(){return a}}});return a}();m("wr.mvc.mgmt.AppManagement",Wc);var Xc={};function Yc(a,b){var c=Zc(a)[b];if(!c)throw Error("Unable to find "+a.configName+" with key '"+b+"'");return c}function T(a){var b=Zc(a);return angular.isArray(b)?b:Object.keys(b).map(function(a){return b[a]})}
function Zc(a){var b=a.configName;if(!b)throw Error("Constructor is not associated with configuration values");var c=Xc[b];if(!c){var d=$c(b);if(angular.isArray(d))c=d.map(function(b,c){return ad(a,c,b)});else if("object"===typeof d)c={},Object.keys(d).forEach(function(b){c[b]=ad(a,b,d[b])});else throw Error("Configuration of "+b+" objects is invalid");Xc[b]=c}return c}
function ad(a,b,c){var d=angular.element(GLOBAL.document).injector();try{return d.instantiate(a,{objectKey:b,objectConfig:c})}catch(e){throw Error("Error constructing "+a.configName+" with key '"+b+"': "+e);}}function bd(a){return angular.element(GLOBAL.document).injector().invoke(a)}function $c(a){return angular.element(GLOBAL.document).injector().invoke(cd).getValue(a)}function cd(a){return new wrm.util.ObjectMapper(a)}cd.$inject=["wrAppManagementConfig"];function U(a){this._name=a}m("wr.mvc.mgmt.DatabaseConfig",U);U.$inject=["objectKey","objectConfig"];U.configName="databases";U.getAll=function(){return T(U)};
U.prototype.clear=function(){var a=this;return new Promise(function(b,c){var d=openDatabase(a._name,"",a._name,2097152);console.log("["+a._name+"] Dropping tables...");d.changeVersion(d.version,"",function(a){a.executeSql("SELECT tbl_name from sqlite_master WHERE type \x3d 'table'",[],function(a,b){var c=b.rows.length,d;for(d=0;d<c;d++){var e=b.rows.item(d).tbl_name;e&&0==e.indexOf("data_")&&a.executeSql("drop table "+e,[])}})},function(b){console.error("["+a._name+"] Drop tables failed");c(b)},function(){console.log("["+
a._name+"] Drop tables done");b()})})};U.prototype.clear=U.prototype.clear;U.prototype.toString=function(){return this._name};U.prototype.toString=U.prototype.toString;function V(a,b,c,d){this._name=a;this._id=b.id;this._router=c;this._manager=d}m("wr.mvc.mgmt.DataClass",V);V.$inject=["objectKey","objectConfig","wrRouter","wrManager"];V.configName="classes";V.getAll=function(){return T(V)};V.get=function(a){return Yc(V,a)};V.prototype.getName=function(){return this._name};V.prototype.getName=V.prototype.getName;
V.prototype.synchronize=function(){var a=this._id,b=this._router,c=this._manager;return Promise.all([c.getDataService(),c.getDataSyncService()]).then(function(c){var e=c[0],f=c[1];c=new dd;gd(c,function(a){return b.notifyEvent(a.getType(),a.getSpecifier(),a.getParameters()||void 0)});hd(c,function(a){throw Error("Attempted to show "+a.getFlavor()+" dialog with mesage '"+a.getMessage()+"'");});var g=new wrm.nav.State(null,c),e=e.getMetadata().getEntity(a);return f.synchronize({entities:[e]},g).then(function(){f.collectSuccessEvents(g)})})};
V.prototype.synchronize=V.prototype.synchronize;V.prototype.clearLastSynchronizationDateTime=function(){var a=this._id,b=this._manager;return Promise.all([b.getDataService(),b.getDataSyncService()]).then(function(b){var d=b[1];b=b[0].getMetadata().getEntity(a);d.clearLastSynchronizationDateTime(b)})};V.prototype.clearLastSynchronizationDateTime=V.prototype.clearLastSynchronizationDateTime;V.prototype.toString=function(){return this._name};V.prototype.toString=V.prototype.toString;function W(a,b){this._code=a;this._languageCode=b.language;this._countryCode=b.country||null}m("wr.mvc.mgmt.Locale",W);W.$inject=["objectKey","objectConfig"];W.configName="locales";W.getAll=function(){return T(W)};W.prototype.getCode=function(){return this._code};W.prototype.getCode=W.prototype.getCode;W.prototype.getLanguageCode=function(){return this._languageCode};W.prototype.getLanguageCode=W.prototype.getLanguageCode;W.prototype.getCountryCode=function(){return this._countryCode};
W.prototype.getCountryCode=W.prototype.getCountryCode;W.refreshApp=function(){function a(a,c,d,e){return c.getLocalizationService().then(function(a){return d.initialize(a)}).then(function(){return d.refreshLocale()}).then(function(c){if(c)return e.notifyEvent("CurrentLocaleChange").then(function(){n(a)})})}a.$inject=["$rootScope","wrManager","wrLocalizationManager","wrRouter"];return bd(a)};W.prototype.toString=function(){return this._code};W.prototype.toString=W.prototype.toString;function dd(){this._dialogHandler=this._eventHandler=null}function gd(a,b){a._eventHandler=b}function hd(a,b){a._dialogHandler=b}l=dd.prototype;l.retrieveView=function(){throw Error("Not supported");};l.markObjectForViewTracking=function(){throw Error("Not supported");};l.retrieveFormState=function(){throw Error("Not supported");};l.handleEvent=function(a){if(this._eventHandler)return this._eventHandler(a);throw Error("Unable to handle event: no event handler available");};
l.enterPanel=function(){throw Error("Not supported");};l.startTimerEvents=function(){throw Error("Not supported");};l.stopTimerEvents=function(){throw Error("Not supported");};l.retrieveEventNotifier=function(){throw Error("Not supported");};l.presentDialog=function(a){if(this._dialogHandler)return this._dialogHandler(a);throw Error("Unable to present dialog: no dialog handler available");};l.reportProgress=function(){};function X(a,b,c){this._name=a;this._parameterNames=b.params;this._notificationManager=c}m("wr.mvc.mgmt.NotificationPoint",X);X.$inject=["objectKey","objectConfig","wrNotificationManager"];X.configName="notifications";X.getAll=function(){return T(X)};X.get=function(a){return Yc(X,a)};X.prototype.getName=function(){return this._name};X.prototype.getName=X.prototype.getName;X.prototype.getParameterNames=function(){return this._parameterNames};X.prototype.getParameterNames=X.prototype.getParameterNames;
X.prototype.sendNotification=function(a,b,c){a=new P(!0,a,b,angular.extend({},c));return this._notificationManager.triggerNotification(this._name,a)};X.prototype.sendNotification=X.prototype.sendNotification;X.prototype.toString=function(){return this._name};X.prototype.toString=X.prototype.toString;function Y(a,b,c,d,e){this._rootScope=b;this._router=c;this._storage=d;this._manager=e}m("wr.mvc.mgmt.Runtime",Y);Y.$inject=["objectConfig","$rootScope","wrRouter","wrStorage","wrManager"];Y.configName="runtime";Y.get=function(){var a=T(Y);if(1!=a.length)throw Error("Invalid runtime engine configuration");return a[0]};Y.prototype.isNavigating=function(){return 0<this._router._runningNotificationCount};Y.prototype.isNavigating=Y.prototype.isNavigating;
Y.prototype.isRendering=function(){var a=this._rootScope;return 0<a.$$asyncQueue.length||0<a.$$postDigestQueue.length||0<a.$$applyAsyncQueue.length?!0:!1};Y.prototype.isRendering=Y.prototype.isRendering;Y.prototype.isBackgroundDownloading=function(){return this._manager.getDataSyncService().then(function(a){return a.isBackgroundDownloading()})};Y.prototype.isBackgroundDownloading=Y.prototype.isBackgroundDownloading;Y.prototype.clearLocalData=function(){this._storage.clearAllDictionaries()};
Y.prototype.clearLocalData=Y.prototype.clearLocalData;Y.prototype.setSynchronizationOrder=function(a){var b=this._manager;return Promise.all([b.getDataService(),b.getDataSyncService()]).then(function(b){var d=b[0];b=b[1];if(a)var e=d.getMetadata(),d=a.map(function(a){return e.getEntity(a._id)});else d=null;b.setPreferredSynchronizationOrder(d)})};Y.prototype.setSynchronizationOrder=Y.prototype.setSynchronizationOrder;Y.prototype.toString=function(){return"Runtime Engine"};Y.prototype.toString=Y.prototype.toString;function Z(a,b,c,d,e,f){this._id=a;this._name=b.name;this._setNames=b.setNames;a=this._setNames.slice(0);a.push(this._name);this._qualifiedName=a.join(" / ");this._location=c;this._route=d;this._routeParams=e;this._rootScope=f}m("wr.mvc.mgmt.Screen",Z);Z.$inject="objectKey objectConfig $location $route $routeParams $rootScope".split(" ");Z.configName="screens";var id=null;Z.getAll=function(){var a=T(Z);jd(a);return a};function kd(a){return Yc(Z,a)}Z.getById=kd;
Z.getByQualifiedName=function(a){a=a.replace(/\s*\/\s*/g," / ").trim();var b=T(Z);jd(b);b=id[a];if(!b)throw Error("Unable to find a screen named '"+a+"'");return b};function jd(a){if(!id){var b={},c=[],d={};a.forEach(function(a){a.getName()||c.push(a._id);var f=a._qualifiedName;b.hasOwnProperty(f)?d[f]=!0:b[f]=a});if(0<c.length)throw Error("Found screens with no name: "+c.join(", "));a=Object.keys(d);if(0<a.length)throw Error("Found conflicting screen qualified names: "+a.join(", "));id=b}}
Z.prototype.getName=function(){return this._name};Z.prototype.getName=Z.prototype.getName;Z.prototype.getSetNames=function(){return this._setNames};Z.prototype.getSetNames=Z.prototype.getSetNames;Z.prototype.getQualifiedName=function(){return this._qualifiedName};Z.prototype.getQualifiedName=Z.prototype.getQualifiedName;
Z.prototype.switchTo=function(){var a=this._location,b=this._route,c=this._routeParams,d=this._rootScope,e=this._id,f="/screens/"+e,g=new Promise(function(a,b){var f=d.$on("$viewContentLoaded",function(){f();g();var d=c.screenId;d===e?a(void 0):b(Error("Reached wrong screen "+d))}),g=d.$on("$routeChangeError",function(){f();g();b(Error("Error switching screen"))})});a.url()===f?b.reload():d.$apply(function(){a.url(f)});return g};Z.prototype.switchTo=Z.prototype.switchTo;
Z.getCurrent=function(){function a(a){return a.screenId?kd(a.screenId):null}a.$inject=["$routeParams"];return bd(a)};Z.registerSwitchListener=function(a){function b(b){return b.$on("$viewContentLoaded",function(){a()})}b.$inject=["$rootScope","$routeParams"];return bd(b)};Z.prototype.toString=function(){return this._qualifiedName+" ("+this._id+")"};Z.prototype.toString=Z.prototype.toString;})();})(this);